(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{546:function(t,a,s){t.exports=s.p+"assets/img/1.c0331a67.png"},547:function(t,a,s){t.exports=s.p+"assets/img/3.1a7b48d0.png"},548:function(t,a,s){t.exports=s.p+"assets/img/4.9e9f286b.png"},549:function(t,a,s){t.exports=s.p+"assets/img/2.c6d798f8.png"},550:function(t,a,s){t.exports=s.p+"assets/img/6.0942d584.png"},551:function(t,a,s){t.exports=s.p+"assets/img/5.964f8fa8.png"},552:function(t,a,s){t.exports=s.p+"assets/img/7.ff4815fb.png"},553:function(t,a,s){t.exports=s.p+"assets/img/8.879ae404.png"},554:function(t,a,s){t.exports=s.p+"assets/img/9.e45ed074.png"},555:function(t,a,s){t.exports=s.p+"assets/img/10.cdf926b2.png"},556:function(t,a,s){t.exports=s.p+"assets/img/11.6283e285.png"},557:function(t,a,s){t.exports=s.p+"assets/img/12.1bae8c28.png"},678:function(t,a,s){"use strict";s.r(a);var n=s(1),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"cordova-app"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cordova-app"}},[t._v("#")]),t._v(" Cordova APP")]),t._v(" "),n("h2",{attrs:{id:"cordova-vue-热更新项目搭建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cordova-vue-热更新项目搭建"}},[t._v("#")]),t._v(" Cordova & Vue 热更新项目搭建")]),t._v(" "),n("p",[n("a",{attrs:{href:"http://cordova.axuer.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cordova"),n("OutboundLink")],1),t._v("Apache Cordova是一个开源的使用 HTML + CSS + JavaScript 做跨平台开发的移动开发框架")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("需要用到开发工具 及 插件")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("Chrome 调试APP插件 (chrome://inspect/#devices)")])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://www.ldmnq.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("雷电模拟器"),n("OutboundLink")],1)])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://developer.android.com/studio",target:"_blank",rel:"noopener noreferrer"}},[t._v("安卓studio"),n("OutboundLink")],1)])]),t._v(" "),n("li",[n("p",[n("a",{attrs:{href:"https://gradle.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("gradle"),n("OutboundLink")],1)])])]),t._v(" "),n("blockquote",[n("p",[n("code",[t._v("Cordova Gradle not found 或 Gradle not install 出现不能打包时进行如下操作")]),t._v("\n在Gradle官网"),n("a",{attrs:{href:"https://gradle.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("由此打开"),n("OutboundLink")],1),t._v("下载最新版本的Gradle。"),n("br")])]),t._v(" "),n("p",[t._v("下载完成后解压到计算机中。"),n("br")]),t._v(" "),n("p",[t._v("新增Path系统环境变量指向Gradle的bin目录。"),n("br")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("E:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("InstallSoftWare"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("andorid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("gradle-6.6.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("bin\n")])])]),n("p",[t._v("执行 gradle -version 检测是否安装成功"),n("br")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("gradle -version\n")])])])]),t._v(" "),n("h2",{attrs:{id:"配置java环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置java环境"}},[t._v("#")]),t._v(" 配置Java环境")]),t._v(" "),n("p",[n("strong",[t._v("下载并安装java开发环境 "),n("a",{attrs:{href:"https://www.cnblogs.com/wangdy/p/5332772.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),n("OutboundLink")],1)])]),t._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[t._v("下载并安装java环境")]),t._v(" "),n("ul",[n("li",[t._v("下载javaJdk： "),n("a",{attrs:{href:"https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("JDK下载 "),n("OutboundLink")],1),t._v(" "),n("br")])]),t._v(" "),n("blockquote",[n("p",[t._v("在安装JDK的时候，会提示你同时安装JRE，可以采用分开装 "),n("code",[t._v("java > (jdk+jre)")]),t._v(" 目录结构`"),n("br")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(546),alt:"asdas"}}),t._v(" "),n("br")])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("变量名：JAVA_HOME "),n("br"),t._v("\n变量值：D:\\Program Files\\Java\\jdk1.7.0 [这是我的安装路径，一定换成你的] "),n("br"),t._v("\n变量名：CLASSPATH "),n("br"),t._v("\n变量值：%JAVA_HOME%\\lib  "),n("br"),t._v("\n变量名：Path  [一般的电脑，都有这个变量名，你只需要编辑就可以] "),n("br"),t._v("\n变量值：%JAVA_HOME%\\bin 换行添加 %JAVA_HOME%\\jre\\bin"),n("br")])]),t._v(" "),n("p",[t._v("检测java  环境是否安装成功 依次执行")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("java  \n\njavac\n")])])]),n("h2",{attrs:{id:"创建cordova项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建cordova项目"}},[t._v("#")]),t._v(" 创建Cordova项目")]),t._v(" "),n("h4",{attrs:{id:"安装cordova"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装cordova"}},[t._v("#")]),t._v(" 安装Cordova")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g cordova\n")])])]),n("h4",{attrs:{id:"创建一个项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建一个项目"}},[t._v("#")]),t._v(" 创建一个项目")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("cordova create MyApp\n")])])]),n("h4",{attrs:{id:"添加一个平台"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加一个平台"}},[t._v("#")]),t._v(" 添加一个平台")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" MyApp \ncordova platform "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" android\n")])])]),n("h4",{attrs:{id:"尝试打包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#尝试打包"}},[t._v("#")]),t._v(" 尝试打包")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("cordova  build\n")])])]),n("h2",{attrs:{id:"添加cordova-hcp-热更新脚手架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加cordova-hcp-热更新脚手架"}},[t._v("#")]),t._v(" 添加Cordova-hcp 热更新脚手架")]),t._v(" "),n("h5",{attrs:{id:"全局安装生成热更新映射文件的脚手架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#全局安装生成热更新映射文件的脚手架"}},[t._v("#")]),t._v(" 全局安装生成热更新映射文件的脚手架")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("cnpm "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g cordova-hot-code-push-cli\n")])])]),n("h5",{attrs:{id:"在-cordova-项目中添加热更新plugin-插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在-cordova-项目中添加热更新plugin-插件"}},[t._v("#")]),t._v(" 在 Cordova 项目中添加热更新plugin  插件")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以上述所创Cordova 项目为例")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v("  MyApp\n\n安装\ncordova plugin "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" cordova-hot-code-push-plugin\n")])])]),n("h2",{attrs:{id:"修改cordova项目里的-config-xml-并且添加关于热更新的配置文件-cordova-hcp-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改cordova项目里的-config-xml-并且添加关于热更新的配置文件-cordova-hcp-json"}},[t._v("#")]),t._v(" 修改"),n("code",[t._v("Cordova项目里")]),t._v("的 "),n("code",[t._v("config.xml")]),t._v(" 并且添加关于热更新的配置文件 "),n("code",[t._v("cordova-hcp.json")])]),t._v(" "),n("h4",{attrs:{id:"修改cordova项目里的config-xml文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改cordova项目里的config-xml文件"}},[t._v("#")]),t._v(" 修改Cordova项目里的config.xml文件")]),t._v(" "),n("blockquote",[n("p",[n("code",[t._v("config-file url")]),t._v(" 指明"),n("code",[t._v("chcp.json")]),t._v("是为了让APP内部的热更插件去做对比 实现差异更新")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("chcp"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auto-download "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),t._v(" /"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("auto-install "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("enabled")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),t._v(" /"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("config-file "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.xmanv.cn/cordova/chcp.json"')]),t._v(" /"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/chcp"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),n("p",[t._v("当 "),n("code",[t._v("auto-download")]),t._v(" 和 "),n("code",[t._v("auto-install")]),t._v(" 都 设置为 "),n("code",[t._v("true")]),t._v(" 时  app就会执行自动更新自动安装 "),n("br"),t._v("\n此处教程不做自动安装更新，而是通过js主动唤起")])]),t._v(" "),n("h4",{attrs:{id:"在config-xml改成以上配置-取消自动下载-取消自动安装-然后通过插件提供的jsapi进行手动更新-以下在deviceready事件触发中示例-仅供参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在config-xml改成以上配置-取消自动下载-取消自动安装-然后通过插件提供的jsapi进行手动更新-以下在deviceready事件触发中示例-仅供参考"}},[t._v("#")]),t._v(" 在config.xml改成以上配置，取消自动下载，取消自动安装，然后通过插件提供的jsAPI进行手动更新，以下在deviceready事件触发中示例（仅供参考）：")]),t._v(" "),n("blockquote",[n("p",[n("strong",[n("code",[t._v("可以再 vue 中 main.js 调用一下代码唤起热更新")])])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isApp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//isApp  是ios或者安卓的时候才执行此段代码  H5代码不需要")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Application Constructor")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("initialize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'deviceready'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onDeviceReady")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Cordova 打开加载完成后会执行的函数")]),t._v("\n            document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"resume"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onDeviceReady")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Cordova  App  从后台切回来会触发的函数")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onDeviceReady")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            \n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" domMask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" domDialog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" chcp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chcp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 检测更新")]),t._v("\n            chcp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetchUpdate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 表示没有更新版本，或者其他错误，详情的信息参考上面的chcp error链接")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// if(npm_cmd.includes("-init-android") || npm_cmd.includes("-test-android")){   //此处可以添加 是否显示进度条的控制')]),t._v("\n                domMask "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dj_code_push_download_mask'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("domMask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    domMask "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    domMask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttribute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dj_code_push_download_mask"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    domMask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<div id=\"dj_code_push_download_dialog\">正在加载新版资源。。。 0%</div>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("domMask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                domDialog "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dj_code_push_download_dialog'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n                console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p:'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("progress "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("':p'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("progress "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isNaN")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("progress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    domDialog"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"正在加载新版资源。。。 "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseInt")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("progress "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }")]),t._v("\n                console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"进度条"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("progress"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//检测是否是否可以进行安装了，双重判断吧，有时候会出现有更新版本但是暂时无法安装的情况（也可以去掉这一层）")]),t._v("\n                chcp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isUpdateAvailableForInstallation")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'No update was loaded => nothing to install'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新中")]),t._v("\n                        chcp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("installUpdate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新失败")]),t._v("\n                                console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Failed to install the update with error code: '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                                console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("description"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新成功")]),t._v("\n                                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//document.body.removeChild(domMask)")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对比版本号")]),t._v("\n                        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Current content version: '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Ready to be installed:'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyToInstallVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initialize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("blockquote",[n("p",[n("strong",[n("code",[t._v("config.xml 文件调整如下")])]),t._v(" "),n("br")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(547),alt:"asdas"}}),t._v(" "),n("br")]),t._v(" "),n("h4",{attrs:{id:"添加关于热更新的配置文件-cordova-hcp-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加关于热更新的配置文件-cordova-hcp-json"}},[t._v("#")]),t._v(" 添加关于热更新的配置文件 "),n("code",[t._v("cordova-hcp.json")])]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[n("code",[t._v("cordova-hcp.json")]),t._v(" 文件的作用是为了在执行 "),n("code",[t._v("cordova-hcp build")]),t._v("  时调用的 否则的话需要每次  使用 "),n("code",[t._v("cordova-hcp init")]),t._v("  去初始化")])]),t._v(" "),n("blockquote",[n("p",[n("code",[t._v("content_url")]),t._v(" 指明APP从哪里获取需要更新的资源")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"autogenerated"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"update"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),t._v(",\n "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content_url"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.xmanv.cn/cordova/"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"配置完成后的项目结构如下截图-当然可以吧vue项目和cordova-项目整合在一起"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置完成后的项目结构如下截图-当然可以吧vue项目和cordova-项目整合在一起"}},[t._v("#")]),t._v(" 配置完成后的项目结构如下截图 "),n("code",[t._v("当然可以吧vue项目和Cordova 项目整合在一起")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(548),alt:"asdas"}}),t._v(" "),n("br")]),t._v(" "),n("blockquote",[n("p",[t._v("至此所有配置已完成 接下来就是把你的vue生成的www  文件拷贝进www文件 然后执行 "),n("code",[t._v("cordova-hcp build")]),t._v("和  "),n("code",[t._v("cordova build")])])]),t._v(" "),n("h2",{attrs:{id:"打包热更新app"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包热更新app"}},[t._v("#")]),t._v(" 打包热更新APP")]),t._v(" "),n("h4",{attrs:{id:"分步打包热更新和app"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#分步打包热更新和app"}},[t._v("#")]),t._v(" 分步打包热更新和APP")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 先生成热更新文件")]),t._v("\ncordova-hcp build\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#打包APP")]),t._v("\ncordova build\n")])])]),n("h4",{attrs:{id:"可以修改-package-json-文件-简化-生成app-以及生成热更新文件的指令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#可以修改-package-json-文件-简化-生成app-以及生成热更新文件的指令"}},[t._v("#")]),t._v(" 可以修改 "),n("code",[t._v("package.json")]),t._v(" 文件 简化 生成APP 以及生成热更新文件的指令")]),t._v(" "),n("ul",[n("li",[t._v("如果vue和Cordova项目整合在一起可以如下配置 "),n("code",[t._v("node build/build.js")]),t._v(" 要根据自己项目的vue打包指令进行调整")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build-android"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node build/build.js   &&  cordova-hcp build && cordova build"')]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成安卓apk包  (生成新app时使用)")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build-android-hot"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node build/build.js   && cordova-hcp build"')]),t._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只生成热更新文件  (热更新app时使用)")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ul",[n("li",[t._v("如果只有Cordova项目("),n("code",[t._v("www下的文件是从其他项目拷贝来的")]),t._v(")则可以如下配置")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build-android"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cordova-hcp build && cordova build"')]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成app")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ul",[n("li",[t._v("如果只有vue项目则可以如下配置")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build-android-hot"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node build/build.js   &&  cordova-hcp build "')]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只生成热更新文件  (热更新app时使用上传服务器就就可以更新app)")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"custom-block danger"},[n("p",{staticClass:"custom-block-title"},[t._v("另外补充个坑（Android上）")]),t._v(" "),n("p",[t._v("笔者是在原用zepto项目一步步重写成vue，使用了vue-router，然后难免有没有重写完成的页面(xxx.html，xxxx.html)，这种我是使用了window.location.href = 'xxx.html'进行跳转（ps:这些xxx.html页面没有使用到原生功能，所以没有引入chcp之类的插件），然后发现在使用了chcp插件后，进行跳转后进行window.history.back()回退到上一个页面（vue页面，使用了chcp插件），会把vue-router的历史记录清空了……")]),t._v(" "),n("p",[t._v("原因应该是chcp初始化的时候，把历史记录清空了，可把这段清空操作注释了，打开cordova项目目录/plugins/cordova-hot-code-push-plugin/src/android/src/com/nordnetab/chcp/main/HotCodePushPlugin.java\n搜索webView.clearHistory();，然后注释掉就好了")])]),t._v(" "),n("h2",{attrs:{id:"vue项目注意事项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue项目注意事项"}},[t._v("#")]),t._v(" VUE项目注意事项")]),t._v(" "),n("h4",{attrs:{id:"_1-添加-cordova-js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-添加-cordova-js"}},[t._v("#")]),t._v(" 1. 添加 cordova.js")]),t._v(" "),n("div",{staticClass:"custom-block danger"},[n("p",{staticClass:"custom-block-title"},[t._v("必须的必")]),t._v(" "),n("p",[t._v("在 "),n("code",[t._v("vue")]),t._v(" 项目中 "),n("code",[t._v("模板文件 index.html")]),t._v(" 中添加如下代码代码 ("),n("code",[t._v("作用是为了能够使H5调用cordova提供的调用原生交互的js方法")]),t._v(")")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/javascript"')]),t._v(" charset"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utf-8"')]),t._v(" src"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cordova.js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),n("p",[t._v("添加如上代码会在H5中导致文件找不到，因为cordova.js 会在打包APP的过程中自动生成，而在H5 项目中则会不存在此文件，解决方法可以是 放个空的cordova.js 在服务器上")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(549),alt:"asdas"}}),t._v(" "),n("br")]),t._v(" "),n("h4",{attrs:{id:"_2-调整webpack配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-调整webpack配置"}},[t._v("#")]),t._v(" 2. 调整webpack配置")]),t._v(" "),n("p",[t._v("调整webpack配置 确保打包出来的 www 文件中 index.html  引用文件的路径为 "),n("code",[t._v("resource/...")]),t._v("  而不是 "),n("code",[t._v("/resource/...")]),t._v(" "),n("br"),t._v("\nH5 中采用的是 "),n("code",[t._v("/resource/...")])]),t._v(" "),n("h2",{attrs:{id:"cordova-plugin-themeablebrowser"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cordova-plugin-themeablebrowser"}},[t._v("#")]),t._v(" Cordova-plugin-themeablebrowser")]),t._v(" "),n("blockquote",[n("p",[n("a",{attrs:{href:"https://github.com/initialxy/cordova-plugin-themeablebrowser",target:"_blank",rel:"noopener noreferrer"}},[t._v("Themeablebrowser"),n("OutboundLink")],1),t._v("是一个外部浏览器插件，它fork自 "),n("a",{attrs:{href:"https://github.com/apache/cordova-plugin-inappbrowser",target:"_blank",rel:"noopener noreferrer"}},[t._v("inappbrowser"),n("OutboundLink")],1),t._v("，相比于后者，此插件的目的是提供一个可以与你的应用程序的主题相匹配的in-app-browser，以便给你的应用保持一致的外观和感觉。所以，除了一些主题化的配置外，核心部分使用参考inappbrowser文档。 "),n("a",{attrs:{href:"https://github.com/initialxy/cordova-plugin-themeablebrowser",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cordova-plugin-themeablebrowser"),n("OutboundLink")],1)])]),t._v(" "),n("ul",[n("li",[t._v("使用内置浏览器打开页面并实现调用H5之间的交互")])]),t._v(" "),n("blockquote",[n("p",[n("a",{attrs:{href:"https://www.jianshu.com/p/b63d120d1e01",target:"_blank",rel:"noopener noreferrer"}},[t._v("交互事件可参考此文章"),n("OutboundLink")],1)])]),t._v(" "),n("ul",[n("li",[t._v("安装插件")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("cordova plugin add cordova-plugin-themeablebrowser\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("插件源码调整")]),t._v(" "),n("p",[t._v("此插件不支持横竖屏打开内置浏览器，需要对源码就行修改才能支持...")])]),t._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[t._v("安卓端的修改")]),t._v(" "),n("p",[t._v("首先找到Cordova项目里的此文件")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("C:\\Users\\Admin\\Desktop\\cordova\\platforms\\android\\app\\src\\main\\java\\com\\initialxy\\cordova\\themeablebrowser\\ThemeableBrowser.java\n")])])]),n("ul",[n("li",[t._v("这是未改之前的代码")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(550),alt:"图片"}}),t._v(" "),n("br")]),t._v(" "),n("ul",[n("li",[t._v("这是更改之后的代码")])]),t._v(" "),n("p",[n("img",{attrs:{src:s(551),alt:"图片"}}),t._v(" "),n("br")]),t._v(" "),n("p",[t._v("只需要在 "),n("code",[t._v("String t = args.optString(1);")]),t._v(" 和 "),n("code",[t._v('if (t == null || t.equals("") || t.equals(NULL)) {')]),t._v("  之间加上如下代码")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('String[] sp = t.split(",");\nt = sp[0];\nString orientation = sp[1];\nif(orientation.equals("LANDSCAPE")){\nthis.cordova.getActivity().setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR_LANDSCAPE);\n}\nif(orientation.equals("PORTRAIT")){\nthis.cordova.getActivity().setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR_PORTRAIT);\n}\n')])])])]),t._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[t._v("苹果端的修改")]),t._v(" "),n("p",[t._v("路径：platforms\\ios\\dj\\Classes\\ AppDelegate.h")]),t._v(" "),n("p",[n("img",{attrs:{src:s(552),alt:"图片"}}),t._v(" "),n("br")]),t._v(" "),n("p",[t._v("路径：platforms\\ios\\dj\\Classes\\ AppDelegate.m")]),t._v(" "),n("p",[n("img",{attrs:{src:s(553),alt:"图片"}}),t._v(" "),n("br")]),t._v(" "),n("p",[t._v("路径：platforms\\ios\\dj\\Plugins\\cordova-plugin-themeablebrowser\\ CDVThemeableBrowser.m")]),t._v(" "),n("p",[n("img",{attrs:{src:s(554),alt:"图片"}}),t._v(" "),n("img",{attrs:{src:s(555),alt:"图片"}})])]),t._v(" "),n("details",{staticClass:"custom-block details"},[n("summary",[t._v("IOS 头部内容被遮挡  cordova-plugin-themeablebrowser 遇到的问题")]),t._v(" "),n("ul",[n("li",[t._v("IOS 头部内容被遮挡")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("- (void) rePositionViews {\n    // Webview height is a bug that appear in the plugin for ios >= 11 so we need to keep the previous code that work great for previous versions\n    if (@available(iOS 11, *)) {\n        \n        CGFloat toolbarHeight = [self getFloatFromDict:_browserOptions.toolbar withKey:kThemeableBrowserPropHeight withDefault:TOOLBAR_DEF_HEIGHT];\n        CGFloat statusBarOffset = [self getStatusBarOffset];\n        CGFloat webviewOffset = _browserOptions.fullscreen ? 0.0 : toolbarHeight + statusBarOffset;\n        \n        if ([_browserOptions.toolbarposition isEqualToString:kThemeableBrowserToolbarBarPositionTop]) {\n            // The webview height calculated did not take the status bar into account. Thus we need to remove status bar height to the webview height.\n            [self.webView setFrame:CGRectMake(self.webView.frame.origin.x, webviewOffset, self.webView.frame.size.width, (self.webView.frame.size.height-statusBarOffset))];\n            [self.toolbar setFrame:CGRectMake(self.toolbar.frame.origin.x, [self getStatusBarOffset], self.toolbar.frame.size.width, self.toolbar.frame.size.height)];\n        }\n        // When positionning the iphone to landscape mode, status bar is hidden. The problem is that we set the webview height just before with removing the status bar height. We need to adjust the phenomen by adding the preview status bar height. We had to add manually 20 (pixel) because in landscape mode, the status bar height is equal to 0.\n        if (statusBarOffset == 0) {\n            [self.webView setFrame:CGRectMake(self.webView.frame.origin.x, webviewOffset, self.webView.frame.size.width, (self.webView.frame.size.height+20))];\n        }\n        \n        CGFloat screenWidth = CGRectGetWidth(self.view.frame);\n        NSInteger width = floorf(screenWidth - self.titleOffset * 2.0f);\n        if (self.titleLabel) {\n            self.titleLabel.frame = CGRectMake(floorf((screenWidth - width) / 2.0f), 0, width, toolbarHeight);\n        }\n        \n        [self layoutButtons];\n        \n    } else {\n        \n        CGFloat toolbarHeight = [self getFloatFromDict:_browserOptions.toolbar withKey:kThemeableBrowserPropHeight withDefault:TOOLBAR_DEF_HEIGHT];\n        CGFloat webviewOffset = _browserOptions.fullscreen ? 0.0 : toolbarHeight;\n        \n        if ([_browserOptions.toolbarposition isEqualToString:kThemeableBrowserToolbarBarPositionTop]) {\n            [self.webView setFrame:CGRectMake(self.webView.frame.origin.x, webviewOffset, self.webView.frame.size.width, self.webView.frame.size.height)];\n            [self.toolbar setFrame:CGRectMake(self.toolbar.frame.origin.x, [self getStatusBarOffset], self.toolbar.frame.size.width, self.toolbar.frame.size.height)];\n        }\n        \n        CGFloat screenWidth = CGRectGetWidth(self.view.frame);\n        NSInteger width = floorf(screenWidth - self.titleOffset * 2.0f);\n        if (self.titleLabel) {\n            self.titleLabel.frame = CGRectMake(floorf((screenWidth - width) / 2.0f), 0, width, toolbarHeight);\n        }\n        \n        [self layoutButtons];\n    }\n}\n")])])]),n("blockquote",[n("p",[t._v("参考：")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/initialxy/cordova-plugin-themeablebrowser/issues/163",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/initialxy/cordova-plugin-themeablebrowser/issues/163"),n("OutboundLink")],1),t._v(" "),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/initialxy/cordova-plugin-themeablebrowser/issues/168",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/initialxy/cordova-plugin-themeablebrowser/issues/168"),n("OutboundLink")],1)]),t._v(" "),n("blockquote",[n("p",[t._v("全面屏手机没有全屏")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/initialxy/cordova-plugin-themeablebrowser/issues/199",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/initialxy/cordova-plugin-themeablebrowser/issues/199"),n("OutboundLink")],1)])]),t._v(" "),n("h2",{attrs:{id:"packer-ng-plugin-带参打包app"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#packer-ng-plugin-带参打包app"}},[t._v("#")]),t._v(" packer-ng-plugin 带参打包APP")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[t._v("使用"),n("a",{attrs:{href:"https://www.openinstall.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("openinstall"),n("OutboundLink")],1),t._v(" 可以轻松实现带参安装，只是需要花钱")])]),t._v(" "),n("blockquote",[n("p",[t._v("快速打包App并把一些参数打入包内  安装后可获取参数")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("安卓实现带参安装功能  需要结合cordova-plugin-app-version插件的cordova.getAppVersion.getVersionNumber的方法")])]),t._v(" "),n("li",[n("p",[t._v("参考文章"),n("br")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/averyyan/cordova-plugin-channel",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/averyyan/cordova-plugin-channel"),n("OutboundLink")],1),n("br")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/averyyan/cordova-plugin-channel",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/averyyan/cordova-plugin-channel"),n("OutboundLink")],1),n("br")]),t._v(" "),n("p",[n("img",{attrs:{src:s(556),alt:"图片"}})]),t._v(" "),n("ul",[n("li",[n("p",[t._v("把 "),n("a",{attrs:{href:"https://github.com/averyyan/cordova-plugin-channel",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/averyyan/cordova-plugin-channel"),n("OutboundLink")],1),t._v("  下载的文件  放到  plugin 插件中")])]),t._v(" "),n("li",[n("p",[t._v("修改此文件的代码")])])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("Cordova\\platforms\\android\\app\\src\\main\\java\\uk\\co\\whiteoctober\\cordova\n")])])]),n("p",[n("img",{attrs:{src:s(557),alt:"图片"}})]),t._v(" "),n("p",[t._v("在js代码中 调用  cordova.getAppVersion  中的 cordova.getAppVersion")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cordova"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getAppVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        cordova"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getAppVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getVersionNumber")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n            window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("appParams"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//保存app参数")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"APP 版本 失败"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);