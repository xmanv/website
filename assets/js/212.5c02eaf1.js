(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{695:function(s,t,n){"use strict";n.r(t);var a=n(1),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"mongodb"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb"}},[s._v("#")]),s._v(" Mongodb")]),s._v(" "),n("h2",{attrs:{id:"一、什么是mongodb"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、什么是mongodb"}},[s._v("#")]),s._v(" 一、什么是mongodb")]),s._v(" "),n("ul",[n("li",[s._v("memcached和redis属于kv数据库(key/value)")]),s._v(" "),n("li",[s._v("mongodb 文档数据库，存储的是文档(Bson->json的二进制化)")])]),s._v(" "),n("p",[n("strong",[s._v("特点：")]),s._v(" 内部执行引擎为JS解释器，把文档存储成bson结构，在查询时，转换为JS对象，并可以通过熟悉的js语法来操作")]),s._v(" "),n("h3",{attrs:{id:"mongo和传统型数据库相比-最大的不同"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongo和传统型数据库相比-最大的不同"}},[s._v("#")]),s._v(" "),n("strong",[s._v("mongo和传统型数据库相比，最大的不同：")])]),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("传统型数据库：")]),s._v(" 结构化数据,定好了表结构后，每一行的内容，必是符合表结构的，就是说--列的个数，类型都一样")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("mongo文档型数据库：")]),s._v(" 表下的每篇文档，都可以有自己独特的结构(json对象都可以有自己独特的属性和值)")])])]),s._v(" "),n("h2",{attrs:{id:"二、安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、安装"}},[s._v("#")]),s._v(" 二、安装")]),s._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel62-3.4.10.tgz\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf mongodb-linux-x86_64-rhel62-3.4.10.tgz\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压过程")]),s._v("\nmongodb-linux-x86_64-rhel62-3.4.10/README\nmongodb-linux-x86_64-rhel62-3.4.10/THIRD-PARTY-NOTICES\nmongodb-linux-x86_64-rhel62-3.4.10/MPL-2\nmongodb-linux-x86_64-rhel62-3.4.10/GNU-AGPL-3.0\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongodump\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongorestore\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongoexport\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongoimport\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongostat\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongotop\nmongodb-linux-x86_64-rhel62-3.4.10/bin/bsondump\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongofiles\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongooplog\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongoreplay\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongoperf\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongod\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongos\nmongodb-linux-x86_64-rhel62-3.4.10/bin/mongo\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# readme")]),s._v("\nMongoDB README\n\nWelcome to MongoDB "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.4")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nCOMPONENTS\n\n  mongod - The database server.\n  mongos - Sharding router.\n  mongo  - The database shell "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uses interactive javascript"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n\nUTILITIES\n\n  mongodump         - Create a binary dump of the contents of a database.\n  mongorestore      - Restore data from the output created by mongodump.\n  mongoexport       - Export the contents of a collection to JSON or CSV.\n  mongoimport       - Import data from JSON, CSV or TSV.\n  mongofiles        - Put, get and delete files from GridFS.\n  mongostat         - Show the status of a running mongod/mongos.\n  bsondump          - Convert BSON files into human-readable formats.\n  mongooplog        - Poll the oplog and apply to a "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" server.\n  mongoreplay       - Traffic capture and replay tool.\n  mongotop          - Track "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" spent reading and writing data.\n\nRUNNING\n\n  For "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line options invoke:\n\n    $ ./mongod --help\n\n  To run a single server database:\n\n    $ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /data/db\n    $ ./mongod\n    $\n    $ "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The mongo javascript shell connects to localhost and test database by default:")]),s._v("\n    $ ./mongo\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 访问web界面")]),s._v("\n./bin/mongod --rest\n默认端口是28017\nhttp://104.223.3.138:28017/\n\n")])])]),n("h2",{attrs:{id:"三、基本使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、基本使用"}},[s._v("#")]),s._v(" 三、基本使用")]),s._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据库")]),s._v("\nshow dbs\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据库")]),s._v("\nuse shengj 并且 db.createCollection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shengj'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用数据库")]),s._v("\nuse shengj\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看表")]),s._v("\nshow tables 或者 show collections\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CURD")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 单条插入")]),s._v("\ndb.shengj.insert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_id:1,name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wangm'")]),s._v(",age:24"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多条插入")]),s._v("\ndb.shengj.insert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_id:3,name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wangm'")]),s._v(",age:24"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_id:2,sex:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'male'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询全部")]),s._v("\ndb.shengj."),n("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("find")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a1f69dfe8b4168b306d93e0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"male"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a1f6bf1e8b4168b306d93e1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangyn"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"female"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ergou"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询1个条件，默认显示_id")]),s._v("\ndb.shengj.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:24"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询1个条件，不显示_id")]),s._v("\ndb.shengj.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:24,_id:0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询多个条件")]),s._v("\ndb.shengj.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wangm'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:24,_id:0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除")]),s._v("\ndb.shengj.remove"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ergou'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新，这里的更新是替换，只保留_id和你写的值")]),s._v("\ndb.shengj.update"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:24"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新，upsert如果没有则创建，有则更新，这个是更新")]),s._v("\ndb.shengj.update"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:wangm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("upsert:true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新，upsert如果没有则创建，有则更新，这个是创建")]),s._v("\ndb.shengj.update"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_id:22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wangm'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("upsert:true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndb.shengj."),n("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("find")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a1f69dfe8b4168b306d93e0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"male"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a1f6bf1e8b4168b306d93e1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangyn"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"female"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询表达式")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ne")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("field:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nq")]),s._v(":value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nin")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" not "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$all")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("field:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$all")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("v1,v2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" 至少包括v1,v2\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$exists")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("field:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$exists")]),s._v(":1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nor")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nor")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("条件1,条件2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" 所有条件都不满足的文档为真返回\n正则 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 用正则表达式查询 以”诺基亚”开头的商品\ndb.goods.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("goods_name:/诺基亚.*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("goods_name:1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$where")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 用"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$where")]),s._v("表达式来查询\ndb.goods.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$where")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'this.cat_id != 3 && this.cat_id != 11'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n注意: 用"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$where")]),s._v("查询时, mongodb是把bson结构的二进制数据转换为json结构的对象,\n然后比较对象的属性是否满足表达式.\n速度较慢\n\n例子：update的option使用\ndb.user.insert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lisi'")]),s._v(",age:12,sex:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'male'")]),s._v(",height:123,area:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'haidian'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndb.user.update"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lisi'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("area:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chaoyang'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$unset")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("height:1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$inc")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$rename")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("sex:"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gender'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndb.user."),n("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("find")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"51fc01c4f5de93e1f2856e33"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"area"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"chaoyang"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gender"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"male"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lisi"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n")])])]),n("h2",{attrs:{id:"四、游标-cursor"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、游标-cursor"}},[s._v("#")]),s._v(" 四、游标 cursor")]),s._v(" "),n("h3",{attrs:{id:"游标是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#游标是什么"}},[s._v("#")]),s._v(" "),n("strong",[s._v("游标是什么")])]),s._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[s._v("通俗的说,游标不是查询结果,而是查询的返回资源,或者接口.\n通过这个接口,你可以逐条读取.\n就像php中的fopen打开文件,得到一个资源一样, 通过资源,可以一行一行的读文件.\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义游标")]),s._v("\nvar mycursor "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" db.shengj.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# while循环游标")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" while"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mycursor.hasNext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". printjson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mycursor.next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a1f69dfe8b4168b306d93e0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"male"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5a1f6bf1e8b4168b306d93e1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangyn"')]),s._v(",\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"female"')]),s._v(",\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wangm"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简写")]),s._v("\nfor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("var  "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cursor")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("db.goods.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("doc")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("cursor.hasNext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" printjson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cursor.next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 游标在分页中的应用")]),s._v("\n比如查到10000行,跳过100页,取10行.\n一般地,我们假设每页N行, 当前是page页\n就需要跳过前 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("page-1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("*N 行, 再取N行, 在mysql中, limit offset,N来实现\n在mongo中,用skip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", limit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("函数来实现的\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询第901页,每页10条")]),s._v("\nvar mytcursor "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" db.bar.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".skip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".limit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过cursor一次性得到所有数据, 并返回数组")]),s._v("\nvar cursor "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" db.goods.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nprintjson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cursor.toArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  //看到所有行\nprintjson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cursor.toArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  //看到第2行\n\n注意: 不要随意使用toArray"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n原因: 会把所有的行立即以对象形式组织在内存里.\n可以在取出少数几行时,用此功能.\n\n")])])]),n("h2",{attrs:{id:"五、索引"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五、索引"}},[s._v("#")]),s._v(" 五、索引")]),s._v(" "),n("ul",[n("li",[s._v("索引提高查询速度,降低写入速度,权衡常用的查询字段,不必在太多列上建索引")]),s._v(" "),n("li",[s._v("在mongodb中,索引可以按字段升序/降序来创建,便于排序")]),s._v(" "),n("li",[s._v("默认是用btree来组织索引文件,2.4版本以后,也允许建立hash索引.")])]),s._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.shengj.find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("age:22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("."),n("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("explain")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"queryPlanner"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"plannerVersion"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"namespace"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shengj.shengj"')]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indexFilterSet"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"parsedQuery"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$eq")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"winningPlan"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stage"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"COLLSCAN"')]),s._v(",\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$eq")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direction"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"forward"')]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rejectedPlans"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"serverInfo"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"omgzui"')]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"port"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.4.10"')]),s._v(",\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gitVersion"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"078f28920cb24de0dd479b5ea6c66c644f6326e9"')]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ok"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前索引状态")]),s._v("\ndb.shengj.getIndexes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建普通单列索引")]),s._v("\ndb.shengj.ensureIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:1/-1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("是升续 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("是降续\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除单个索引")]),s._v("\ndb.shengj.dropIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:1/-1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除所有索引")]),s._v("\ndb.shengj.dropIndexes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建多列索引")]),s._v("\ndb.shengj.ensureIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:1/-1, mobile:1/-1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建子文档索引")]),s._v("\ndb.shengj.ensureIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name.subfield:1/-1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建唯一索引")]),s._v("\ndb.shengj.ensureIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name.subfield:1/-1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("unique:true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建哈希索引(2.4新增的)")]),s._v("\n哈希索引速度比普通索引快,但是,无能对范围查询进行优化.\n适宜于---随机性强的散列\ndb.shengj.ensureIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name:’hashed’"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重建索引")]),s._v("\n一个表经过很多次修改后,导致表的文件产生空洞,索引文件也如此.\n可以通过索引的重建,减少索引文件碎片,并提高索引的效率.\n类似mysql中的optimize table\n\ndb.shengj.reIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])])]),n("h2",{attrs:{id:"六、mongodb导出与导入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六、mongodb导出与导入"}},[s._v("#")]),s._v(" 六、Mongodb导出与导入")]),s._v(" "),n("h2",{attrs:{id:"七、mongodb的用户管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#七、mongodb的用户管理"}},[s._v("#")]),s._v(" 七、mongodb的用户管理")]),s._v(" "),n("h2",{attrs:{id:"八、分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#八、分片"}},[s._v("#")]),s._v(" 八、分片")]),s._v(" "),n("h2",{attrs:{id:"九、参考资料"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#九、参考资料"}},[s._v("#")]),s._v(" 九、参考资料")])])}),[],!1,null,null,null);t.default=e.exports}}]);