<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ´¾å‘æ›´æ–° | å„ç´¢æ–¯</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="å„ç´¢æ–¯">
    
    <link rel="preload" href="/assets/css/0.styles.c7cd9109.css" as="style"><link rel="preload" href="/assets/js/app.d98f75d3.js" as="script"><link rel="preload" href="/assets/js/7.9b6d0533.js" as="script"><link rel="preload" href="/assets/js/49.21eaf609.js" as="script"><link rel="prefetch" href="/assets/js/1.2c63f614.js"><link rel="prefetch" href="/assets/js/10.cc5d14b9.js"><link rel="prefetch" href="/assets/js/100.c8f44be0.js"><link rel="prefetch" href="/assets/js/101.795b3d75.js"><link rel="prefetch" href="/assets/js/102.aaec7d00.js"><link rel="prefetch" href="/assets/js/103.2d2b0842.js"><link rel="prefetch" href="/assets/js/104.eb790654.js"><link rel="prefetch" href="/assets/js/105.a7704875.js"><link rel="prefetch" href="/assets/js/106.8ab9cd83.js"><link rel="prefetch" href="/assets/js/107.ee3ce424.js"><link rel="prefetch" href="/assets/js/108.08e2cedb.js"><link rel="prefetch" href="/assets/js/109.877c3f78.js"><link rel="prefetch" href="/assets/js/11.c24817ef.js"><link rel="prefetch" href="/assets/js/110.f5da30a6.js"><link rel="prefetch" href="/assets/js/111.f2577856.js"><link rel="prefetch" href="/assets/js/112.b680de7f.js"><link rel="prefetch" href="/assets/js/113.4d4df4c4.js"><link rel="prefetch" href="/assets/js/114.30de0066.js"><link rel="prefetch" href="/assets/js/115.d5ecc68f.js"><link rel="prefetch" href="/assets/js/116.6147f600.js"><link rel="prefetch" href="/assets/js/117.3c3956df.js"><link rel="prefetch" href="/assets/js/118.daae1fb1.js"><link rel="prefetch" href="/assets/js/119.436d3d29.js"><link rel="prefetch" href="/assets/js/12.ab5f7c80.js"><link rel="prefetch" href="/assets/js/120.1095d1d6.js"><link rel="prefetch" href="/assets/js/121.9f460f74.js"><link rel="prefetch" href="/assets/js/122.6fa65276.js"><link rel="prefetch" href="/assets/js/123.21855554.js"><link rel="prefetch" href="/assets/js/124.94f826a4.js"><link rel="prefetch" href="/assets/js/125.09bdd832.js"><link rel="prefetch" href="/assets/js/126.8d53ae81.js"><link rel="prefetch" href="/assets/js/127.4cb9031f.js"><link rel="prefetch" href="/assets/js/128.2f929363.js"><link rel="prefetch" href="/assets/js/129.0164eea0.js"><link rel="prefetch" href="/assets/js/13.89dc7a50.js"><link rel="prefetch" href="/assets/js/130.f39a3d30.js"><link rel="prefetch" href="/assets/js/131.084ce4d5.js"><link rel="prefetch" href="/assets/js/132.ee4812c0.js"><link rel="prefetch" href="/assets/js/133.f1302ee1.js"><link rel="prefetch" href="/assets/js/134.11df087f.js"><link rel="prefetch" href="/assets/js/135.1a2c8799.js"><link rel="prefetch" href="/assets/js/136.ca35b1d9.js"><link rel="prefetch" href="/assets/js/137.c1c23e5a.js"><link rel="prefetch" href="/assets/js/138.df2c8355.js"><link rel="prefetch" href="/assets/js/139.6157decf.js"><link rel="prefetch" href="/assets/js/14.3fc06e57.js"><link rel="prefetch" href="/assets/js/140.4c38a48a.js"><link rel="prefetch" href="/assets/js/141.55c239b4.js"><link rel="prefetch" href="/assets/js/142.367377a7.js"><link rel="prefetch" href="/assets/js/143.8a9e6059.js"><link rel="prefetch" href="/assets/js/144.00e6656d.js"><link rel="prefetch" href="/assets/js/145.84cfacef.js"><link rel="prefetch" href="/assets/js/146.d978c83e.js"><link rel="prefetch" href="/assets/js/147.a686cf28.js"><link rel="prefetch" href="/assets/js/148.e49d61a9.js"><link rel="prefetch" href="/assets/js/149.3910416e.js"><link rel="prefetch" href="/assets/js/15.18eacd20.js"><link rel="prefetch" href="/assets/js/150.3d9b5905.js"><link rel="prefetch" href="/assets/js/151.d990fa49.js"><link rel="prefetch" href="/assets/js/152.8d8a08ae.js"><link rel="prefetch" href="/assets/js/153.d51531ce.js"><link rel="prefetch" href="/assets/js/154.d374b646.js"><link rel="prefetch" href="/assets/js/155.e9153498.js"><link rel="prefetch" href="/assets/js/156.2295824e.js"><link rel="prefetch" href="/assets/js/157.221f67d7.js"><link rel="prefetch" href="/assets/js/158.8d252154.js"><link rel="prefetch" href="/assets/js/159.bb952efd.js"><link rel="prefetch" href="/assets/js/16.003392c7.js"><link rel="prefetch" href="/assets/js/160.69b9d123.js"><link rel="prefetch" href="/assets/js/161.00964eb4.js"><link rel="prefetch" href="/assets/js/162.197ee17a.js"><link rel="prefetch" href="/assets/js/163.caf0dd1b.js"><link rel="prefetch" href="/assets/js/164.27d90c5e.js"><link rel="prefetch" href="/assets/js/165.40e17a44.js"><link rel="prefetch" href="/assets/js/166.9abc86d0.js"><link rel="prefetch" href="/assets/js/167.2de82e8a.js"><link rel="prefetch" href="/assets/js/168.ba4950d5.js"><link rel="prefetch" href="/assets/js/169.f0c8adfc.js"><link rel="prefetch" href="/assets/js/17.2edc3b56.js"><link rel="prefetch" href="/assets/js/170.a6e3bb7d.js"><link rel="prefetch" href="/assets/js/171.593e2067.js"><link rel="prefetch" href="/assets/js/172.36cd1436.js"><link rel="prefetch" href="/assets/js/173.6b57ad74.js"><link rel="prefetch" href="/assets/js/174.03337b28.js"><link rel="prefetch" href="/assets/js/175.4f6a4c1f.js"><link rel="prefetch" href="/assets/js/176.09f161df.js"><link rel="prefetch" href="/assets/js/177.2213b875.js"><link rel="prefetch" href="/assets/js/178.cafdf490.js"><link rel="prefetch" href="/assets/js/179.feacf7af.js"><link rel="prefetch" href="/assets/js/18.f505ab09.js"><link rel="prefetch" href="/assets/js/180.bf1dbeef.js"><link rel="prefetch" href="/assets/js/181.d276a202.js"><link rel="prefetch" href="/assets/js/182.03ac25a5.js"><link rel="prefetch" href="/assets/js/183.b47e8331.js"><link rel="prefetch" href="/assets/js/184.25ea842d.js"><link rel="prefetch" href="/assets/js/185.2248daa0.js"><link rel="prefetch" href="/assets/js/186.a741edc6.js"><link rel="prefetch" href="/assets/js/187.c49038cb.js"><link rel="prefetch" href="/assets/js/188.5a0b84b4.js"><link rel="prefetch" href="/assets/js/189.e57ab776.js"><link rel="prefetch" href="/assets/js/19.2c169746.js"><link rel="prefetch" href="/assets/js/190.a9a5cc1c.js"><link rel="prefetch" href="/assets/js/191.b2afd445.js"><link rel="prefetch" href="/assets/js/192.3e160249.js"><link rel="prefetch" href="/assets/js/193.2e244d10.js"><link rel="prefetch" href="/assets/js/194.0cca6a12.js"><link rel="prefetch" href="/assets/js/195.8739fd87.js"><link rel="prefetch" href="/assets/js/196.a2bb2397.js"><link rel="prefetch" href="/assets/js/197.956fc688.js"><link rel="prefetch" href="/assets/js/198.66f69c0f.js"><link rel="prefetch" href="/assets/js/199.b827fc45.js"><link rel="prefetch" href="/assets/js/2.21097652.js"><link rel="prefetch" href="/assets/js/20.6e0f26b3.js"><link rel="prefetch" href="/assets/js/200.4b00ce4c.js"><link rel="prefetch" href="/assets/js/201.9b0c1e1e.js"><link rel="prefetch" href="/assets/js/202.a9af8076.js"><link rel="prefetch" href="/assets/js/203.c0be8adc.js"><link rel="prefetch" href="/assets/js/204.8bcc79bc.js"><link rel="prefetch" href="/assets/js/205.00c3c477.js"><link rel="prefetch" href="/assets/js/206.20684736.js"><link rel="prefetch" href="/assets/js/207.c3bae5d4.js"><link rel="prefetch" href="/assets/js/208.f4893253.js"><link rel="prefetch" href="/assets/js/209.bcbcbbc0.js"><link rel="prefetch" href="/assets/js/21.b2bf15f4.js"><link rel="prefetch" href="/assets/js/210.e9e5e48d.js"><link rel="prefetch" href="/assets/js/211.a0a8a270.js"><link rel="prefetch" href="/assets/js/212.5c02eaf1.js"><link rel="prefetch" href="/assets/js/213.6294a9ff.js"><link rel="prefetch" href="/assets/js/214.3ed1eb4d.js"><link rel="prefetch" href="/assets/js/215.8f25e14f.js"><link rel="prefetch" href="/assets/js/216.a87422ef.js"><link rel="prefetch" href="/assets/js/217.04172ea8.js"><link rel="prefetch" href="/assets/js/218.cc7e2ed1.js"><link rel="prefetch" href="/assets/js/219.85486019.js"><link rel="prefetch" href="/assets/js/22.48c2b927.js"><link rel="prefetch" href="/assets/js/220.ec7c320c.js"><link rel="prefetch" href="/assets/js/221.28e9c245.js"><link rel="prefetch" href="/assets/js/222.16544296.js"><link rel="prefetch" href="/assets/js/223.c5c1ce99.js"><link rel="prefetch" href="/assets/js/224.6880421a.js"><link rel="prefetch" href="/assets/js/225.c3f92a83.js"><link rel="prefetch" href="/assets/js/226.40f270aa.js"><link rel="prefetch" href="/assets/js/227.d62c2d8a.js"><link rel="prefetch" href="/assets/js/228.aba13d31.js"><link rel="prefetch" href="/assets/js/229.44ca3451.js"><link rel="prefetch" href="/assets/js/23.f0c36b62.js"><link rel="prefetch" href="/assets/js/230.3b213ef9.js"><link rel="prefetch" href="/assets/js/231.28b50ce4.js"><link rel="prefetch" href="/assets/js/232.fa39e933.js"><link rel="prefetch" href="/assets/js/233.ac4d0586.js"><link rel="prefetch" href="/assets/js/234.071e87e4.js"><link rel="prefetch" href="/assets/js/235.868144c0.js"><link rel="prefetch" href="/assets/js/236.0296f995.js"><link rel="prefetch" href="/assets/js/237.403a3412.js"><link rel="prefetch" href="/assets/js/238.daea8867.js"><link rel="prefetch" href="/assets/js/239.eb087f06.js"><link rel="prefetch" href="/assets/js/24.e8f8e362.js"><link rel="prefetch" href="/assets/js/240.d4ab8404.js"><link rel="prefetch" href="/assets/js/241.97c9fbd3.js"><link rel="prefetch" href="/assets/js/242.6704d369.js"><link rel="prefetch" href="/assets/js/243.0e033d3e.js"><link rel="prefetch" href="/assets/js/244.044ecbf1.js"><link rel="prefetch" href="/assets/js/245.410785ce.js"><link rel="prefetch" href="/assets/js/246.14c088a3.js"><link rel="prefetch" href="/assets/js/247.9884e5e0.js"><link rel="prefetch" href="/assets/js/248.a846fce2.js"><link rel="prefetch" href="/assets/js/249.97495793.js"><link rel="prefetch" href="/assets/js/25.647a5e87.js"><link rel="prefetch" href="/assets/js/250.a4e51ca4.js"><link rel="prefetch" href="/assets/js/251.b8ca7adb.js"><link rel="prefetch" href="/assets/js/252.37cd53f8.js"><link rel="prefetch" href="/assets/js/253.9601a997.js"><link rel="prefetch" href="/assets/js/254.05042942.js"><link rel="prefetch" href="/assets/js/255.c5861c26.js"><link rel="prefetch" href="/assets/js/256.8fcbdd02.js"><link rel="prefetch" href="/assets/js/257.67510f4b.js"><link rel="prefetch" href="/assets/js/258.91805015.js"><link rel="prefetch" href="/assets/js/259.511ee284.js"><link rel="prefetch" href="/assets/js/26.c1cfda81.js"><link rel="prefetch" href="/assets/js/260.a56226e0.js"><link rel="prefetch" href="/assets/js/261.d4cf1ac5.js"><link rel="prefetch" href="/assets/js/262.d16e1f07.js"><link rel="prefetch" href="/assets/js/263.face0a4b.js"><link rel="prefetch" href="/assets/js/264.10e85017.js"><link rel="prefetch" href="/assets/js/265.bb6823f6.js"><link rel="prefetch" href="/assets/js/266.3d568f9b.js"><link rel="prefetch" href="/assets/js/267.3b7928eb.js"><link rel="prefetch" href="/assets/js/268.8cff3378.js"><link rel="prefetch" href="/assets/js/269.eae18960.js"><link rel="prefetch" href="/assets/js/27.d0336482.js"><link rel="prefetch" href="/assets/js/270.46032f02.js"><link rel="prefetch" href="/assets/js/28.d717b1f5.js"><link rel="prefetch" href="/assets/js/29.2b3ed4c1.js"><link rel="prefetch" href="/assets/js/3.8fe6c5b7.js"><link rel="prefetch" href="/assets/js/30.71461641.js"><link rel="prefetch" href="/assets/js/31.f2001d9e.js"><link rel="prefetch" href="/assets/js/32.5bdb44b7.js"><link rel="prefetch" href="/assets/js/33.d1508194.js"><link rel="prefetch" href="/assets/js/34.88fedc22.js"><link rel="prefetch" href="/assets/js/35.25f52724.js"><link rel="prefetch" href="/assets/js/36.8650cfcb.js"><link rel="prefetch" href="/assets/js/37.34d337cc.js"><link rel="prefetch" href="/assets/js/38.0b5c0c3d.js"><link rel="prefetch" href="/assets/js/39.64841af4.js"><link rel="prefetch" href="/assets/js/4.0354a99a.js"><link rel="prefetch" href="/assets/js/40.53c7bd37.js"><link rel="prefetch" href="/assets/js/41.12b90b8d.js"><link rel="prefetch" href="/assets/js/42.632cb960.js"><link rel="prefetch" href="/assets/js/43.31422ca0.js"><link rel="prefetch" href="/assets/js/44.2f1ec7a7.js"><link rel="prefetch" href="/assets/js/45.f242a906.js"><link rel="prefetch" href="/assets/js/46.67d7d1e4.js"><link rel="prefetch" href="/assets/js/47.8d28b24f.js"><link rel="prefetch" href="/assets/js/48.06caeae2.js"><link rel="prefetch" href="/assets/js/5.d2b0b862.js"><link rel="prefetch" href="/assets/js/50.97ad10e3.js"><link rel="prefetch" href="/assets/js/51.2e71e75c.js"><link rel="prefetch" href="/assets/js/52.c6d671f3.js"><link rel="prefetch" href="/assets/js/53.bc0d5dc2.js"><link rel="prefetch" href="/assets/js/54.d9f936ea.js"><link rel="prefetch" href="/assets/js/55.3002fb0a.js"><link rel="prefetch" href="/assets/js/56.8f9707bc.js"><link rel="prefetch" href="/assets/js/57.b602b7ce.js"><link rel="prefetch" href="/assets/js/58.15366835.js"><link rel="prefetch" href="/assets/js/59.c0c54498.js"><link rel="prefetch" href="/assets/js/60.b322f4c9.js"><link rel="prefetch" href="/assets/js/61.a1134c78.js"><link rel="prefetch" href="/assets/js/62.85e02486.js"><link rel="prefetch" href="/assets/js/63.d5d33b82.js"><link rel="prefetch" href="/assets/js/64.5d8d1885.js"><link rel="prefetch" href="/assets/js/65.76eb3fe3.js"><link rel="prefetch" href="/assets/js/66.f62a6671.js"><link rel="prefetch" href="/assets/js/67.dae8c600.js"><link rel="prefetch" href="/assets/js/68.deaed188.js"><link rel="prefetch" href="/assets/js/69.15d8cdee.js"><link rel="prefetch" href="/assets/js/70.d2c29e20.js"><link rel="prefetch" href="/assets/js/71.d17c01f3.js"><link rel="prefetch" href="/assets/js/72.44b6d918.js"><link rel="prefetch" href="/assets/js/73.50c13da3.js"><link rel="prefetch" href="/assets/js/74.5cb28037.js"><link rel="prefetch" href="/assets/js/75.05deb588.js"><link rel="prefetch" href="/assets/js/76.5f62dbf6.js"><link rel="prefetch" href="/assets/js/77.99601b23.js"><link rel="prefetch" href="/assets/js/78.edb6c2b5.js"><link rel="prefetch" href="/assets/js/79.f2ad254b.js"><link rel="prefetch" href="/assets/js/8.a68d98c9.js"><link rel="prefetch" href="/assets/js/80.f3e863a8.js"><link rel="prefetch" href="/assets/js/81.417d38a3.js"><link rel="prefetch" href="/assets/js/82.4a0a5c47.js"><link rel="prefetch" href="/assets/js/83.df57062c.js"><link rel="prefetch" href="/assets/js/84.ef963e13.js"><link rel="prefetch" href="/assets/js/85.e64fbc8a.js"><link rel="prefetch" href="/assets/js/86.ed6d8d4b.js"><link rel="prefetch" href="/assets/js/87.fa1ec07f.js"><link rel="prefetch" href="/assets/js/88.30a7489f.js"><link rel="prefetch" href="/assets/js/89.cf14fa85.js"><link rel="prefetch" href="/assets/js/9.6988d7b0.js"><link rel="prefetch" href="/assets/js/90.29ec7531.js"><link rel="prefetch" href="/assets/js/91.730bb06e.js"><link rel="prefetch" href="/assets/js/92.b798233d.js"><link rel="prefetch" href="/assets/js/93.7b01b894.js"><link rel="prefetch" href="/assets/js/94.43472e9c.js"><link rel="prefetch" href="/assets/js/95.7bc57d03.js"><link rel="prefetch" href="/assets/js/96.c1dc8585.js"><link rel="prefetch" href="/assets/js/97.f93c94db.js"><link rel="prefetch" href="/assets/js/98.d44e7bc5.js"><link rel="prefetch" href="/assets/js/99.d4d46160.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c7cd9109.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/newlogo.png" alt="å„ç´¢æ–¯" class="logo"> <span class="site-name can-hide">å„ç´¢æ–¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/typescript/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="FrontEnd" class="dropdown-title"><span class="title">FrontEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="FrontEnd" class="mobile-dropdown-title"><span class="title">FrontEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          å‰ç«¯å¼€å‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/" class="nav-link">
  å‰ç«¯ä¹±ç‚–
</a></li><li class="dropdown-subitem"><a href="/ECMAScript/" class="nav-link">
  ECMAScript ES6-ES11
</a></li></ul></li><li class="dropdown-item"><h4>
          Vueå¼€å‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress/" class="nav-link">
  VuePress
</a></li><li class="dropdown-subitem"><a href="/vueAnalysis/introduction/" class="nav-link">
  Vueæºç åˆ†æ
</a></li></ul></li><li class="dropdown-item"><h4>
          è‡ªåŠ¨åŒ–æµ‹è¯•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/vueTest.html" class="nav-link">
  Vueåº”ç”¨æµ‹è¯•
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScriptä¹¦ç±
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/javascript/know-up.html" class="nav-link">
  ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)
</a></li><li class="dropdown-subitem"><a href="/books/javascript/know-down.html" class="nav-link">
  ä½ ä¸çŸ¥é“çš„JavaScript(ä¸­ä¸‹)
</a></li><li class="dropdown-subitem"><a href="/books/javascript/red-book.html" class="nav-link">
  JavaScripté«˜çº§ç¨‹åºè®¾è®¡
</a></li><li class="dropdown-subitem"><a href="/books/javascript/algorithm.html" class="nav-link">
  JavaScriptæ•°æ®ç»“æ„å’Œç®—æ³•
</a></li><li class="dropdown-subitem"><a href="/designPattern/" class="nav-link">
  JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ
</a></li><li class="dropdown-subitem"><a href="/books/javascript/es6.html" class="nav-link">
  æ·±å…¥ç†è§£ES6
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="BackEnd" class="dropdown-title"><span class="title">BackEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="BackEnd" class="mobile-dropdown-title"><span class="title">BackEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          åç«¯å¼€å‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/node/koa.html" class="nav-link">
  ğŸ“š Koa2æ–‡æ¡£ 
</a></li><li class="dropdown-subitem"><a href="/backend/mysql.html" class="nav-link">
  ğŸ“š Mysqlæ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/backend/redisdocs.html" class="nav-link">
  ğŸ“š Redisæ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">
  ğŸ“š Dockeræ–‡æ¡£
</a></li></ul></li><li class="dropdown-item"><h4>
          æœåŠ¡å™¨ç¯å¢ƒéƒ¨ç½²
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/centos.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Nginx(CentOs7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/node.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Node&amp;pm2(CentOs7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/mysql.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Mysql(CentOs7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/redisinstall.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Redis(CentOS7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/https.html" class="nav-link">
  Lets Encryptç”Ÿæˆhttpsè¯ä¹¦
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevTools" class="dropdown-title"><span class="title">DevTools</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevTools" class="mobile-dropdown-title"><span class="title">DevTools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          å¸¸ç”¨å·¥å…·
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/webpack/" class="nav-link">
  ğŸ“š Webpack
</a></li><li class="dropdown-subitem"><a href="/books/git/" class="nav-link">
  ğŸ“š Git
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others" class="dropdown-title"><span class="title">Others</span> <span class="arrow down"></span></button> <button type="button" aria-label="Others" class="mobile-dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          å¤–éƒ¨é“¾æ¥
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.linuxcool.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“š Linuxå‘½ä»¤å¤§å…¨
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://www.xmanv.com/" target="_blank" rel="noopener noreferrer" class="repo-link">
    MyBlog
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/typescript/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="FrontEnd" class="dropdown-title"><span class="title">FrontEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="FrontEnd" class="mobile-dropdown-title"><span class="title">FrontEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          å‰ç«¯å¼€å‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/" class="nav-link">
  å‰ç«¯ä¹±ç‚–
</a></li><li class="dropdown-subitem"><a href="/ECMAScript/" class="nav-link">
  ECMAScript ES6-ES11
</a></li></ul></li><li class="dropdown-item"><h4>
          Vueå¼€å‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress/" class="nav-link">
  VuePress
</a></li><li class="dropdown-subitem"><a href="/vueAnalysis/introduction/" class="nav-link">
  Vueæºç åˆ†æ
</a></li></ul></li><li class="dropdown-item"><h4>
          è‡ªåŠ¨åŒ–æµ‹è¯•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/vueTest.html" class="nav-link">
  Vueåº”ç”¨æµ‹è¯•
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScriptä¹¦ç±
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/books/javascript/know-up.html" class="nav-link">
  ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)
</a></li><li class="dropdown-subitem"><a href="/books/javascript/know-down.html" class="nav-link">
  ä½ ä¸çŸ¥é“çš„JavaScript(ä¸­ä¸‹)
</a></li><li class="dropdown-subitem"><a href="/books/javascript/red-book.html" class="nav-link">
  JavaScripté«˜çº§ç¨‹åºè®¾è®¡
</a></li><li class="dropdown-subitem"><a href="/books/javascript/algorithm.html" class="nav-link">
  JavaScriptæ•°æ®ç»“æ„å’Œç®—æ³•
</a></li><li class="dropdown-subitem"><a href="/designPattern/" class="nav-link">
  JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ
</a></li><li class="dropdown-subitem"><a href="/books/javascript/es6.html" class="nav-link">
  æ·±å…¥ç†è§£ES6
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="BackEnd" class="dropdown-title"><span class="title">BackEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="BackEnd" class="mobile-dropdown-title"><span class="title">BackEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          åç«¯å¼€å‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/node/koa.html" class="nav-link">
  ğŸ“š Koa2æ–‡æ¡£ 
</a></li><li class="dropdown-subitem"><a href="/backend/mysql.html" class="nav-link">
  ğŸ“š Mysqlæ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/backend/redisdocs.html" class="nav-link">
  ğŸ“š Redisæ–‡æ¡£
</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">
  ğŸ“š Dockeræ–‡æ¡£
</a></li></ul></li><li class="dropdown-item"><h4>
          æœåŠ¡å™¨ç¯å¢ƒéƒ¨ç½²
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/centos.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Nginx(CentOs7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/node.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Node&amp;pm2(CentOs7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/mysql.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Mysql(CentOs7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/redisinstall.html" class="nav-link">
  é˜¿é‡Œäº‘éƒ¨ç½²Redis(CentOS7.5)
</a></li><li class="dropdown-subitem"><a href="/backend/https.html" class="nav-link">
  Lets Encryptç”Ÿæˆhttpsè¯ä¹¦
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevTools" class="dropdown-title"><span class="title">DevTools</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevTools" class="mobile-dropdown-title"><span class="title">DevTools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          å¸¸ç”¨å·¥å…·
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/webpack/" class="nav-link">
  ğŸ“š Webpack
</a></li><li class="dropdown-subitem"><a href="/books/git/" class="nav-link">
  ğŸ“š Git
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others" class="dropdown-title"><span class="title">Others</span> <span class="arrow down"></span></button> <button type="button" aria-label="Others" class="mobile-dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          å¤–éƒ¨é“¾æ¥
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.linuxcool.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“š Linuxå‘½ä»¤å¤§å…¨
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://www.xmanv.com/" target="_blank" rel="noopener noreferrer" class="repo-link">
    MyBlog
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ä»‹ç»</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/introduction/" class="sidebar-link">ä»‹ç»å’Œå‚è€ƒ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æºç ç›®å½•è®¾è®¡å’Œæ¶æ„è®¾è®¡</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/design/" class="sidebar-link">è®¾è®¡</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Rollupæ„å»ºç‰ˆæœ¬</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/rollup/" class="sidebar-link">RollupåŸºç¡€çŸ¥è¯†</a></li><li><a href="/vueAnalysis/rollup/vue.html" class="sidebar-link">Vueä¸­çš„Rollupæ„å»º</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ä»å…¥å£åˆ°æ„é€ å‡½æ•°æ•´ä½“æµç¨‹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/entry/" class="sidebar-link">æ•´ä½“æµç¨‹</a></li><li><a href="/vueAnalysis/entry/global.html" class="sidebar-link">initGlobalAPIæµç¨‹</a></li><li><a href="/vueAnalysis/entry/init.html" class="sidebar-link">initMixinæµç¨‹</a></li><li><a href="/vueAnalysis/entry/state.html" class="sidebar-link">stateMixinæµç¨‹</a></li><li><a href="/vueAnalysis/entry/events.html" class="sidebar-link">eventsMixinæµç¨‹</a></li><li><a href="/vueAnalysis/entry/lifecycle.html" class="sidebar-link">lifecycleMixinæµç¨‹</a></li><li><a href="/vueAnalysis/entry/render.html" class="sidebar-link">renderMixinæµç¨‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å“åº”å¼åŸç†</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/reactive/" aria-current="page" class="sidebar-link">ä»‹ç»</a></li><li><a href="/vueAnalysis/reactive/prepare.html" class="sidebar-link">å‰ç½®æ ¸å¿ƒæ¦‚å¿µ</a></li><li><a href="/vueAnalysis/reactive/props.html" class="sidebar-link">propså¤„ç†</a></li><li><a href="/vueAnalysis/reactive/methods.html" class="sidebar-link">methodså¤„ç†</a></li><li><a href="/vueAnalysis/reactive/data.html" class="sidebar-link">dataå¤„ç†</a></li><li><a href="/vueAnalysis/reactive/computed.html" class="sidebar-link">computedå¤„ç†</a></li><li><a href="/vueAnalysis/reactive/watch.html" class="sidebar-link">watchå¤„ç†</a></li><li><a href="/vueAnalysis/reactive/reactive.html" class="sidebar-link">æ·±å…¥å“åº”å¼åŸç†</a></li><li><a href="/vueAnalysis/reactive/dep.html" class="sidebar-link">ä¾èµ–æ”¶é›†</a></li><li><a href="/vueAnalysis/reactive/notify.html" aria-current="page" class="active sidebar-link">æ´¾å‘æ›´æ–°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vueAnalysis/reactive/notify.html#åœºæ™¯" class="sidebar-link">åœºæ™¯</a></li><li class="sidebar-sub-header"><a href="/vueAnalysis/reactive/notify.html#è¿‡ç¨‹" class="sidebar-link">è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="/vueAnalysis/reactive/notify.html#æ­»å¾ªç¯" class="sidebar-link">æ­»å¾ªç¯</a></li><li class="sidebar-sub-header"><a href="/vueAnalysis/reactive/notify.html#æ•´ä½“æµç¨‹å›¾" class="sidebar-link">æ•´ä½“æµç¨‹å›¾</a></li></ul></li><li><a href="/vueAnalysis/reactive/nexttick.html" class="sidebar-link">nextTickå®ç°åŸç†</a></li><li><a href="/vueAnalysis/reactive/problem.html" class="sidebar-link">å˜åŒ–ä¾¦æµ‹æ³¨æ„äº‹é¡¹</a></li><li><a href="/vueAnalysis/reactive/api.html" class="sidebar-link">å˜åŒ–ä¾¦æµ‹APIå®ç°</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è™šæ‹ŸDOMå’ŒVNode</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/dom/" class="sidebar-link">è™šæ‹ŸDOM</a></li><li><a href="/vueAnalysis/dom/vnode.html" class="sidebar-link">VNodeä»‹ç»</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç»„ä»¶åŒ–</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/component/" class="sidebar-link">ç»„ä»¶åŒ–ä»‹ç»</a></li><li><a href="/vueAnalysis/component/mount.html" class="sidebar-link">$mountæ–¹æ³•</a></li><li><a href="/vueAnalysis/component/render.html" class="sidebar-link">renderå’ŒrenderProxy</a></li><li><a href="/vueAnalysis/component/createElement.html" class="sidebar-link">createElement</a></li><li><a href="/vueAnalysis/component/createComponent.html" class="sidebar-link">createComponent</a></li><li><a href="/vueAnalysis/component/merge.html" class="sidebar-link">åˆå¹¶ç­–ç•¥</a></li><li><a href="/vueAnalysis/component/patch.html" class="sidebar-link">patch</a></li><li><a href="/vueAnalysis/component/lifecycle.html" class="sidebar-link">ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="/vueAnalysis/component/register.html" class="sidebar-link">ç»„ä»¶æ³¨å†Œ</a></li><li><a href="/vueAnalysis/component/async.html" class="sidebar-link">å¼‚æ­¥ç»„ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¼–è¯‘åŸç†</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/compile/" class="sidebar-link">ç¼–è¯‘åŸç†ä»‹ç»</a></li><li><a href="/vueAnalysis/compile/parse.html" class="sidebar-link">parseæ¨¡æ¿è§£æ</a></li><li><a href="/vueAnalysis/compile/optimize.html" class="sidebar-link">optimizeä¼˜åŒ–</a></li><li><a href="/vueAnalysis/compile/codegen.html" class="sidebar-link">codegenä»£ç ç”Ÿæˆ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ‰©å±•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/expand/" class="sidebar-link">æ‰©å±•</a></li><li><a href="/vueAnalysis/expand/directive.html" class="sidebar-link">directiveæŒ‡ä»¤</a></li><li><a href="/vueAnalysis/expand/filter.html" class="sidebar-link">filterè¿‡æ»¤å™¨</a></li><li><a href="/vueAnalysis/expand/vmodel.html" class="sidebar-link">v-model</a></li><li><a href="/vueAnalysis/expand/event.html" class="sidebar-link">eventäº‹ä»¶å¤„ç†</a></li><li><a href="/vueAnalysis/expand/slot.html" class="sidebar-link">æ™®é€šæ’æ§½å’Œä½œç”¨åŸŸæ’æ§½</a></li><li><a href="/vueAnalysis/expand/components.html" class="sidebar-link">å†…ç½®ç»„ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue-Router</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/router/" class="sidebar-link">Vue-Routerä»‹ç»</a></li><li><a href="/vueAnalysis/router/register.html" class="sidebar-link">è·¯ç”±æ³¨å†Œ</a></li><li><a href="/vueAnalysis/router/matcher.html" class="sidebar-link">matcherä»‹ç»</a></li><li><a href="/vueAnalysis/router/change.html" class="sidebar-link">è·¯ç”±åˆ‡æ¢</a></li><li><a href="/vueAnalysis/router/components.html" class="sidebar-link">å†…ç½®ç»„ä»¶</a></li><li><a href="/vueAnalysis/router/hooks.html" class="sidebar-link">è·¯ç”±hooksé’©å­å‡½æ•°</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vuex</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueAnalysis/vuex/" class="sidebar-link">Vuexä»‹ç»</a></li><li><a href="/vueAnalysis/vuex/init.html" class="sidebar-link">Vuexåˆå§‹åŒ–</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="æ´¾å‘æ›´æ–°"><a href="#æ´¾å‘æ›´æ–°" class="header-anchor">#</a> æ´¾å‘æ›´æ–°</h1> <p>åœ¨ä»‹ç»å®Œä¾èµ–æ”¶é›†åï¼Œæˆ‘ä»¬ç´§æ¥ç€æ¥åˆ†æä¸€ä¸‹æ´¾å‘æ›´æ–°ã€‚åœ¨è¿™ä¸€å°èŠ‚ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¼„æ¸…æ¥šæ´¾å‘æ›´æ–°ä¸»è¦åšä»€ä¹ˆäº‹æƒ…ä»¥åŠæ´¾å‘æ›´æ–°çš„å…·ä½“è¿‡ç¨‹å®ç°ã€‚</p> <p>æˆ‘ä»¬å…ˆæ¥å›ç­”ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>
é—®ï¼šæ´¾å‘æ›´æ–°ä¸»è¦åšä»€ä¹ˆäº‹æƒ…ï¼Ÿ<br>
ç­”ï¼šæ´¾å‘æ›´æ–°å°±æ˜¯å½“å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŠ¨çš„æ—¶å€™ï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜…äº†è¿™ä¸ªæ•°æ®å˜åŒ–çš„<code>Watcher</code>(æ—¢<code>Dep</code>ä¾èµ–)æ‰§è¡Œ<code>update</code>ã€‚å¯¹äº<code>render watcher</code>æ¸²æŸ“<code>Watcher</code>è€Œè¨€ï¼Œ<code>update</code>å°±æ˜¯è§¦å‘ç»„ä»¶é‡æ–°è¿›è¡Œæ¸²æŸ“ï¼›å¯¹äº<code>computed watcher</code>è®¡ç®—å±æ€§<code>Watcher</code>è€Œè¨€ï¼Œ<code>update</code>å°±æ˜¯å¯¹è®¡ç®—å±æ€§é‡æ–°æ±‚å€¼ï¼›å¯¹äº<code>user watcher</code>ç”¨æˆ·è‡ªå®šä¹‰<code>Watcher</code>è€Œè¨€ï¼Œ<code>update</code>å°±æ˜¯è°ƒç”¨ç”¨æˆ·æä¾›çš„å›è°ƒå‡½æ•°ã€‚</p> <h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="header-anchor">#</a> åœºæ™¯</h2> <p>å¤§å¤šæ•°äººåˆ†ææ´¾å‘æ›´æ–°çš„åœºæ™¯ï¼Œåªè¯´æ˜äº†<code>Object.defineProperty()</code>æ–¹æ³•ä¸­<code>setter</code>è¢«è§¦å‘çš„æ—¶å€™ä¼šè¿›è¡Œæ´¾å‘æ›´æ–°ï¼Œå…¶å®ä¸€å…±æœ‰å››å¤„æ´¾å‘æ›´æ–°çš„åœ°æ–¹ï¼Œå…¶å®ƒä¸‰å¤„åˆ†åˆ«ä¸ºï¼š</p> <ul><li><code>Vue.js</code>ä¸­ä¸ƒç§æ•°ç»„å˜å¼‚æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šè¿›è¡Œæ´¾å‘æ›´æ–°ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> methodsToPatch <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'shift'</span><span class="token punctuation">,</span> <span class="token string">'unshift'</span><span class="token punctuation">,</span> <span class="token string">'splice'</span><span class="token punctuation">,</span> <span class="token string">'sort'</span><span class="token punctuation">,</span> <span class="token string">'reverse'</span><span class="token punctuation">]</span>

methodsToPatch<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">def</span><span class="token punctuation">(</span>arrayMethods<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">mutator</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç²¾ç®€ä»£ç </span>
    ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><code>Vue.set</code>æˆ–è€…<code>this.$set</code>çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ´¾å‘æ›´æ–°ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">set</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token operator">|</span> Object<span class="token punctuation">,</span> key<span class="token operator">:</span> any<span class="token punctuation">,</span> val<span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
  <span class="token comment">// ç²¾ç®€ä»£ç </span>
  <span class="token function">defineReactive</span><span class="token punctuation">(</span>ob<span class="token punctuation">.</span>value<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
  ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> val
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>Vue.delete</code>æˆ–è€…<code>this.$delete</code>çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ´¾å‘æ›´æ–°ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">del</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token operator">|</span> Object<span class="token punctuation">,</span> key<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç²¾ç®€ä»£ç </span>
  <span class="token keyword">delete</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ob<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶ä¸­ï¼Œä»¥ä¸Šä¸‰ç§æ´¾å‘æ›´æ–°ä¸<code>Object.defineProperty()</code>æ–¹æ³•ä¸­çš„<code>setter</code>è¢«è§¦å‘æ—¶çš„æ´¾å‘æ›´æ–°æœ‰ä¸€ç‚¹ä¸ä¸€æ ·ï¼Œ<code>setter</code>ä¸­çš„æ´¾å‘æ›´æ–°ï¼Œå®ƒçš„<code>dep</code>æ˜¯ä¸€ä¸ªåœ¨<code>defineReactive</code>æ–¹æ³•ä¸­å®šä¹‰çš„é—­åŒ…å˜é‡ï¼Œæ„å‘³ç€å…¶åªèƒ½æœåŠ¡äº<code>defineReactive</code>æ–¹æ³•ã€‚å‰è€…çš„<code>dep</code>æ˜¯ä»<code>this.__ob__</code>å¯¹è±¡ä¸­å–çš„ï¼Œ<code>this.__ob__</code>å±æ€§æ˜¯åœ¨<code>Observer</code>è¢«å®ä¾‹åŒ–çš„æ—¶å€™è¢«å®šä¹‰çš„ï¼Œå®ƒæŒ‡å‘<code>Observer</code>å®ä¾‹ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰å·²ç»ä»‹ç»è¿‡ã€‚è¿™ç§ç‹¬ç‰¹çš„å¤„ç†æ–¹å¼ï¼Œæ–¹ä¾¿äº†æˆ‘ä»¬åœ¨ä»¥ä¸Šä¸‰ç§åœºæ™¯ä¸‹ï¼Œèƒ½æ–¹ä¾¿çš„è¯»å–åˆ°<code>dep</code>ä¾èµ–ï¼Œè¿›è€Œè¿›è¡Œä¾èµ–çš„æ´¾å‘æ›´æ–°ã€‚</p> <h2 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="header-anchor">#</a> è¿‡ç¨‹</h2> <p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬ä»¥åŠäº†è§£åˆ°äº†<code>dep.notify()</code>è¢«è°ƒç”¨çš„å„ç§æ—¶æœºï¼Œåœ¨è¿™ä¸€ä¸ªå°èŠ‚ä¸­æˆ‘ä»¬éœ€è¦æ¥çœ‹ä¸€ä¸‹æ´¾å‘æ›´æ–°çš„è¿‡ç¨‹ã€‚</p> <p>å½“<code>dep.notify()</code>è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œ<code>notify()</code>æ–¹æ³•ä¸­çš„ä»£ç ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>Dep</code>ç±»ä¸­å…³äºè¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">notify</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> subs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> subs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    subs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥å‘ç°ï¼Œ<code>notify</code>ä¸»è¦åšçš„å°±æ˜¯éå†<code>subs</code>æ•°ç»„ï¼Œç„¶åè°ƒç”¨<code>update</code>æ–¹æ³•ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>Watcher</code>ç±»ä¸­å…³äº<code>update</code>æ–¹æ³•çš„ä»£ç å®ç°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> queueWatcher <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./scheduler'</span>
<span class="token function">update</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨<code>update</code>æ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆåˆ¤æ–­äº†<code>this.lazy</code>å’Œ<code>this.sync</code>ä¸¤ä¸ªå±æ€§ï¼Œå…¶ä¸­<code>this.lazy</code>ä¸º<code>computed watcher</code>è®¡ç®—å±æ€§çš„æ ‡å¿—ï¼Œå› ä¸ºè®¡ç®—å±æ€§ä¼šå»¶åè¿›è¡Œæ±‚å€¼ï¼Œå› æ­¤è¿™é‡Œåªæ˜¯æŠŠ<code>this.dirty</code>èµ‹å€¼ä¸º<code>true</code>ï¼Œ<code>this.sync</code>ä¸å±äºæ´¾å‘æ›´æ–°è¿™ä¸€ç« èŠ‚çš„é‡ç‚¹ï¼Œå› æ­¤ä¸åšè¿‡å¤šçš„ä»‹ç»ã€‚</p> <p>æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æ<code>queueWatcher</code>ï¼Œå®ƒæ˜¯æ’°å†™åœ¨<code>observer/scheduler.js</code>æ–‡ä»¶ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queue<span class="token operator">:</span> Array<span class="token operator">&lt;</span>Watcher<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> has<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> waiting <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> flushing <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">queueWatcher</span> <span class="token punctuation">(</span><span class="token parameter">watcher<span class="token operator">:</span> Watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id
  <span class="token keyword">if</span> <span class="token punctuation">(</span>has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flushing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// if already flushing, splice the watcher based on its id</span>
      <span class="token comment">// if already past its id, it will be run next immediately.</span>
      <span class="token keyword">let</span> i <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> index <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&gt;</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        i<span class="token operator">--</span>
      <span class="token punctuation">}</span>
      queue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> watcher<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// queue the flush</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>waiting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      waiting <span class="token operator">=</span> <span class="token boolean">true</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>config<span class="token punctuation">.</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">flushSchedulerQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token function">nextTick</span><span class="token punctuation">(</span>flushSchedulerQueue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥åœ¨ä»¥ä¸Šä»£ç æœ€é¡¶éƒ¨å‘ç°å®šä¹‰äº†å‡ ä¸ªå˜é‡ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å˜é‡ï¼Œå®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹ï¼š</p> <ul><li><code>queue</code>ï¼šå„ç§<code>Watcher</code>æ‰§è¡Œé˜Ÿåˆ—ï¼Œæ— è®ºæ˜¯<code>render watcher</code>ã€<code>user watcher</code>è¿˜æ˜¯<code>computed watcher</code>ï¼Œåªè¦ä¸æ˜¯é‡å¤çš„<code>Watcher</code>ï¼Œæœ€ç»ˆéƒ½ä¼šè¢«æ¨å…¥åˆ°<code>queue</code>é˜Ÿåˆ—æ•°ç»„ä¸­ã€‚</li> <li><code>has</code>ï¼šç”¨æ¥é˜²æ­¢é‡å¤æ·»åŠ <code>Watcher</code>çš„æ ‡å¿—å¯¹è±¡ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¡¨ç¤ºidä¸º1,2çš„Watcherå®ä¾‹å·²ç»è¢«æ·»åŠ åˆ°äº†queue</span>
<span class="token comment">// åç»­é‡åˆ°åŒæ ·çš„Watcherå®ä¾‹ï¼Œä¸ä¼šé‡å¤æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­</span>
<span class="token keyword">const</span> has <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>index</code>ï¼šå½“å‰éå†çš„<code>Watcher</code>å®ä¾‹ç´¢å¼•ï¼Œå®ƒå°±æ˜¯<code>flushSchedulerQueue</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>for</code>å¾ªç¯éå†<code>queue</code>é˜Ÿåˆ—æ•°ç»„çš„<code>index</code>ã€‚</li></ul> <p>ä»‹ç»å®Œä»¥ä¸Šå‡ ä¸ªé‡è¦å˜é‡åï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹<code>queueWatcher</code>çš„è¿‡ç¨‹ï¼š</p> <ul><li>ä»£ç é¦–å…ˆé€šè¿‡è·å–å½“å‰<code>Watcher</code>çš„è‡ªå¢<code>id</code>ï¼Œåˆ¤æ–­åœ¨æ ‡å¿—å¯¹è±¡<code>has</code>ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å¯¹è¿™ä¸ª<code>id</code>è¿›è¡Œæ ‡è®°ï¼Œèµ‹å€¼ä¸º<code>true</code>ã€‚</li> <li>éšååˆ¤æ–­æ˜¯å¦ä¸º<code>flushing</code>çŠ¶æ€ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä»£è¡¨æˆ‘ä»¬å¯ä»¥æ­£å¸¸çš„æŠŠå½“å‰<code>Watcher</code>æ¨å…¥åˆ°<code>queue</code>é˜Ÿåˆ—æ•°ç»„ä¸­ã€‚</li> <li>æ¥ç€åˆ¤æ–­äº†æ˜¯å¦ä¸º<code>waiting</code>çŠ¶æ€ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä»£è¡¨å¯ä»¥æ‰§è¡Œ<code>queue</code>é˜Ÿåˆ—æ•°ç»„ï¼Œç„¶åè®¾ç½®<code>waiting</code>ä¸º<code>true</code>ï¼Œæœ€åè°ƒç”¨<code>nextTick(flushSchedulerQueue)</code>ï¼Œ<code>nextTick</code>æ–¹æ³•æ˜¯<code>Vue.js</code>è‡ªå·±å°è£…çš„ä¸€ä¸ªå¤„ç†å¼‚æ­¥é€»è¾‘çš„å·¥å…·å‡½æ•°ï¼Œæˆ‘ä»¬ç°åœ¨åªè¦çŸ¥é“ï¼š<code>nextTick</code>ä¸­çš„å‡½æ•°å‚æ•°ï¼Œä¼šåœ¨ä¸‹ä¸€ä¸ª<code>tick</code>æ‰§è¡Œã€‚</li></ul> <p>æ¥ç€ï¼Œæˆ‘ä»¬æ¥çœ‹<code>flushSchedulerQueue</code>å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">flushSchedulerQueue</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  currentFlushTimestamp <span class="token operator">=</span> <span class="token function">getNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  flushing <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">let</span> watcher<span class="token punctuation">,</span> id

  <span class="token comment">// Sort queue before flush.</span>
  <span class="token comment">// This ensures that:</span>
  <span class="token comment">// 1. Components are updated from parent to child. (because parent is always</span>
  <span class="token comment">//    created before the child)</span>
  <span class="token comment">// 2. A component's user watchers are run before its render watcher (because</span>
  <span class="token comment">//    user watchers are created before the render watcher)</span>
  <span class="token comment">// 3. If a component is destroyed during a parent component's watcher run,</span>
  <span class="token comment">//    its watchers can be skipped.</span>
  queue<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>id <span class="token operator">-</span> b<span class="token punctuation">.</span>id<span class="token punctuation">)</span>

  <span class="token comment">// do not cache length because more watchers might be pushed</span>
  <span class="token comment">// as we run existing watchers</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> queue<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    watcher <span class="token operator">=</span> queue<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>before<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      watcher<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id
    has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    watcher<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// in dev build, check and stop circular updates.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token constant">MAX_UPDATE_COUNT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span>
          <span class="token string">'You may have an infinite update loop '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>
            watcher<span class="token punctuation">.</span>user
              <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">in watcher with expression &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>watcher<span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span>
              <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">in a component render function.</span><span class="token template-punctuation string">`</span></span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
          watcher<span class="token punctuation">.</span>vm
        <span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// keep copies of post queues before resetting state</span>
  <span class="token keyword">const</span> activatedQueue <span class="token operator">=</span> activatedChildren<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> updatedQueue <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">resetSchedulerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// call component updated and activated hooks</span>
  <span class="token function">callActivatedHooks</span><span class="token punctuation">(</span>activatedQueue<span class="token punctuation">)</span>
  <span class="token function">callUpdatedHooks</span><span class="token punctuation">(</span>updatedQueue<span class="token punctuation">)</span>

  <span class="token comment">// devtool hook</span>
  <span class="token comment">/* istanbul ignore if */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>devtools <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>devtools<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    devtools<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'flush'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬ç²—ç•¥è§‚çœ‹<code>flushSchedulerQueue</code>å‡½æ•°ä»£ç ï¼Œå¯ä»¥å‘ç°å®ƒä¸»è¦åšå‡ ä»¶äº‹æƒ…ï¼š<strong>è¿˜åŸflushingçŠ¶æ€</strong>ã€<strong>æ’åºqueueé˜Ÿåˆ—</strong>ã€<strong>éå†queue</strong>ã€<strong>è¿˜åŸçŠ¶æ€</strong>ã€<strong>è§¦å‘ç»„ä»¶é’©å­å‡½æ•°</strong>ã€‚æˆ‘ä»¬æŒ‰ç…§è¿™å‡ ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«è¯´æ˜:</p> <ul><li><strong>è¿˜åŸflushingçŠ¶æ€</strong>ï¼šåœ¨<code>flushSchedulerQueue</code>é¦–å…ˆå¯¹<code>flushing</code>è¿›è¡Œäº†è¿˜åŸï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ä¸å½±å“åœ¨æ‰§è¡Œ<code>queue</code>é˜Ÿåˆ—çš„æ—¶å€™ï¼Œæœ‰<code>Watcher</code>æ¨å…¥åˆ°<code>queue</code>é˜Ÿåˆ—ä¸­ã€‚</li> <li><strong>æ’åºqueueé˜Ÿåˆ—</strong>ï¼šä½¿ç”¨æ•°ç»„çš„<code>sort</code>æ–¹æ³•ï¼ŒæŠŠ<code>queue</code>é˜Ÿåˆ—ä¸­çš„<code>Watcher</code>æŒ‰ç…§è‡ªå¢<code>id</code>çš„å€¼ä»å°åˆ°å¤§è¿›è¡Œäº†æ’åºï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†ä¿è¯ä»¥ä¸‹ä¸‰ç§åœºæ™¯ï¼š</li></ul> <ol><li>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç»„ä»¶çš„æ›´æ–°æ˜¯ä»çˆ¶ç»„ä»¶å¼€å§‹ï¼Œç„¶ååˆ°å­ç»„ä»¶ã€‚åœ¨ç»„ä»¶æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šä»çˆ¶ç»„ä»¶å¼€å§‹æ¸²æŸ“ï¼Œè¿™æ—¶å€™ä¼šåˆ›å»ºçˆ¶ç»„ä»¶çš„<code>render watcher</code>ï¼Œå‡è®¾æ­¤æ—¶çš„<code>parent render watcher</code>è‡ªå¢<code>id</code>ä¸º<code>1</code>ï¼Œæ¥ç€æ¸²æŸ“å­ç»„ä»¶ï¼Œå®ä¾‹åŒ–å­ç»„ä»¶çš„<code>render watcher</code>ï¼Œå‡è®¾æ­¤æ—¶çš„<code>child render watcher</code>è‡ªå¢<code>id</code>ä¸º<code>2</code>ã€‚è¿›è¡Œ<code>queue.sort()</code>æ’åºåï¼Œ<code>id</code>å€¼å°çš„æ’åºåˆ°æ•°ç»„å‰é¢ï¼Œè¿™æ ·åœ¨<code>queue</code>è¿›è¡Œéå†çš„æ—¶å€™ï¼Œå°±èƒ½ä¿è¯é¦–å…ˆå¤„ç†<code>parent render watcher</code>ï¼Œç„¶åå†å¤„ç†<code>child render watcher</code></li> <li>å› ä¸ºç”¨æˆ·è‡ªå®šä¹‰<code>Watcher</code>å¯ä»¥åœ¨ç»„ä»¶æ¸²æŸ“ä¹‹å‰åˆ›å»ºï¼Œå› æ­¤å¯¹äºç”¨æˆ·è‡ªå®šä¹‰<code>Watcher</code>è€Œè¨€ï¼Œéœ€è¦ä¼˜å…ˆäº<code>render watcher</code>æ‰§è¡Œã€‚</li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>change<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      msg<span class="token operator">:</span> <span class="token string">'msg'</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span> <span class="token number">23</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// å…ˆæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå†ç»„ä»¶æ¸²æŸ“</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">change</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="3"><li>å¦‚æœä¸€ä¸ªå­ç»„ä»¶åœ¨çˆ¶ç»„ä»¶æ‰§è¡Œ<code>queueWatcher</code>çš„è¿‡ç¨‹ä¸­è¢«é”€æ¯äº†ï¼Œé‚£ä¹ˆå­ç»„ä»¶æ‰€æœ‰çš„<code>Watcher</code>æ‰§è¡Œéƒ½åº”è¯¥è·³è¿‡ã€‚</li></ol> <ul><li><strong>éå†queue</strong>ï¼šåœ¨ä½¿ç”¨<code>for</code>å¾ªç¯éå†çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„éå†æ¡ä»¶ï¼Œå®ƒå…ˆå¯¹<code>queue</code>çš„é•¿åº¦è¿›è¡Œäº†æ±‚å€¼ï¼Œç„¶åå†åˆ¤æ–­å¾ªç¯æ¡ä»¶ï¼Œè¿™æ ·åšæ˜¯å› ä¸ºåœ¨éå†<code>queue</code>æ•°ç»„çš„è¿‡ç¨‹ä¸­ï¼Œ<code>queue</code>æ•°ç»„ä¸­çš„å…ƒç´ æœ‰å¯èƒ½ä¼šå‘ç”Ÿå˜åŠ¨ã€‚åœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆä¼šé‡Šæ”¾å½“å‰<code>Watcher</code>åœ¨<code>has</code>æ ‡å¿—å¯¹è±¡ä¸­çš„çŠ¶æ€ï¼Œç„¶åè°ƒç”¨<code>watcher.run()</code>æ–¹æ³•ã€‚<code>run</code>æ˜¯å®šä¹‰åœ¨<code>Watcher</code>ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç²¾ç®€ä»£ç </span>
  <span class="token function">run</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        value <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">||</span>
        <span class="token comment">// Deep watchers and watchers on Object/Arrays should fire even</span>
        <span class="token comment">// when the value is the same, because the value may</span>
        <span class="token comment">// have mutated.</span>
        <span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deep
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// set new value</span>
        <span class="token keyword">const</span> oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">callback for watcher &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>run</code>æ–¹æ³•çš„ä»£ç ä¸æ˜¯å¾ˆå¤æ‚ï¼Œå°±æ˜¯å¯¹ä¸åŒçš„<code>Watcher</code>è¿›è¡Œä¸åŒçš„å¤„ç†ï¼Œå¦‚æœæ˜¯<code>render watcher</code>ï¼Œå®ƒåœ¨æ‰§è¡Œ<code>this.get()</code>çš„è¿‡ç¨‹ä¸­ä¼šæ‰§è¡Œ<code>this.getter</code>ï¼Œ<code>this.getter</code>å¯¹åº”ä»¥ä¸‹æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç»„ä»¶æ¸²æŸ“æ–¹æ³•</span>
  vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚æœæ˜¯<code>user watcher</code>ï¼Œå…¶<code>this.user</code>å€¼ä¸º<code>true</code>ï¼Œä¼šè°ƒç”¨<code>this.cb.call()</code>ï¼Œæ­¤æ—¶çš„<code>this.cb</code>å°±æ˜¯ç”¨æˆ·å†™çš„<code>user callback</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token operator">:</span> <span class="token string">'msg'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// user callback</span>
    <span class="token comment">// this.cb = userCallback</span>
    <span class="token keyword">const</span> <span class="token function-variable function">userCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">,</span> userCallback<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚æœæ˜¯<code>computed watcher</code>ï¼Œå…¶<code>this.user</code>å€¼ä¸º<code>false</code>ï¼Œä¼šè°ƒç”¨<code>this.cb.call()</code>ï¼Œæ­¤æ—¶çš„<code>this.cb</code>å°±æ˜¯æˆ‘ä»¬æä¾›çš„è®¡ç®—å±æ€§æ–¹æ³•:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token operator">:</span> <span class="token string">'msg'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// this.cb = newMsg () {}</span>
    <span class="token function">newMsg</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">+</span> <span class="token string">'!!!'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>è¿˜åŸçŠ¶æ€</strong>ï¼šè°ƒç”¨<code>resetSchedulerState</code>å‡½æ•°çš„ç›®çš„æ˜¯ï¼Œå½“<code>queue</code>é˜Ÿåˆ—éƒ½æ‰§è¡Œå®Œæ¯•æ—¶ï¼ŒæŠŠæ‰€æœ‰ç›¸å…³çŠ¶æ€è¿˜åŸä¸ºåˆå§‹çŠ¶æ€ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬<code>queue</code>ã€<code>has</code>å’Œ<code>index</code>ç­‰ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">resetSchedulerState</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  index <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">=</span> activatedChildren<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>
  has <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    circular <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  waiting <span class="token operator">=</span> flushing <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>è§¦å‘ç»„ä»¶é’©å­å‡½æ•°</strong>ï¼šè°ƒç”¨<code>callActivatedHooks</code>å’Œ<code>callUpdatedHooks</code>åˆ†åˆ«æ˜¯ä¸ºäº†è§¦å‘ç»„ä»¶<code>activated</code>å’Œ<code>updated</code>é’©å­å‡½æ•°ï¼Œå…¶ä¸­<code>activated</code>æ˜¯ä¸<code>keep-alive</code>ç›¸å…³çš„é’©å­å‡½æ•°ã€‚</li></ul> <h2 id="æ­»å¾ªç¯"><a href="#æ­»å¾ªç¯" class="header-anchor">#</a> æ­»å¾ªç¯</h2> <p>åœ¨ä½¿ç”¨<code>Vue.js</code>è¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šä¸å°å¿ƒå†™å‡ºæ­»å¾ªç¯çš„ä»£ç ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>change<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token operator">:</span> <span class="token string">'msg'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">change</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">msg</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®è°ƒç”¨<code>change</code>æ–¹æ³•ä¿®æ”¹<code>this.msg</code>çš„å€¼çš„æ—¶å€™ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨<code>watch</code>ç›‘å¬äº†<code>msg</code>çš„å€¼æ›´æ–°ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œ<code>watch</code>ç›‘å¬å‡½æ•°ï¼Œä½†æ˜¯åœ¨<code>watch</code>ç›‘å¬å‡½æ•°ä¸­æˆ‘ä»¬åˆä¿®æ”¹äº†<code>this.msg</code>çš„å€¼ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä¸€ç›´è°ƒç”¨æˆ‘ä»¬å†™çš„ç›‘å¬å‡½æ•°ï¼Œå­˜åœ¨ä¸€ä¸ªæ­»å¾ªç¯ã€‚åœ¨<code>Vue.js</code>ä¸­ï¼Œä¸ºäº†é¿å…æ­»å¾ªç¯å¯¼è‡´æµè§ˆå™¨å´©æºƒï¼Œå®ƒåšäº†ç‰¹æ®Šå¤„ç†ã€‚</p> <p>åœ¨<code>queueWatcher</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åˆ†æä»¥ä¸‹<code>else</code>è¿™æ®µä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">MAX_UPDATE_COUNT</span> <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">let</span> circular<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> number <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flushing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// if already flushing, splice the watcher based on its id</span>
  <span class="token comment">// if already past its id, it will be run next immediately.</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> index <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&gt;</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    i<span class="token operator">--</span>
  <span class="token punctuation">}</span>
  queue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> watcher<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬ä»¥ä¸Šé¢çš„ä¾‹å­æ¥åˆ†æä»¥ä¸‹è¿™æ®µä»£ç ï¼š</p> <ul><li>å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®ä¿®æ”¹<code>this.msg</code>çš„å€¼çš„æ—¶å€™ï¼Œè§¦å‘<code>msg</code>çš„<code>setter</code>ï¼Œç„¶åè¿›è¡Œ<code>dep.notify</code>æ´¾å‘æ›´æ–°ï¼Œæ¥ç€è°ƒç”¨<code>queueWatcher</code>ï¼Œæ­¤æ—¶<code>msg</code>å­˜åœ¨ä¸¤ä¸ª<code>Dep</code>ä¾èµ–ï¼Œä¸€ä¸ªæ˜¯<code>render watcher</code>ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯<code>user watcher</code>ï¼Œå› æ­¤<code>this.subs</code>æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º<code>2</code>çš„<code>Watcher</code>æ•°ç»„ã€‚å½“åˆæ¬¡<code>queueWatcher</code>çš„æ—¶å€™ï¼Œ<code>flushing</code>çŠ¶æ€ä¸º<code>false</code>ï¼Œå› ä¸º<code>user watcher</code>æ¯”<code>render watcher</code>å…ˆåˆ›å»ºï¼Œå› æ­¤è¿™ä¸ªæ—¶å€™<code>user watcher</code>ä¼šå…ˆæ¨å…¥åˆ°<code>queue</code>é˜Ÿåˆ—ï¼Œæ¥ç€æ˜¯<code>render watcher</code>:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å±•ç¤ºä½¿ç”¨ï¼Œå®é™…ä¸ºWatcherå®ä¾‹</span>
<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'user watcher'</span><span class="token punctuation">,</span> <span class="token string">'render watcher'</span><span class="token punctuation">]</span>
</code></pre></div><ul><li>æ¥ç€ä¼šæ‰§è¡Œ<code>watch</code>ç›‘å¬å‡½æ•°ï¼Œå†æ¬¡æ‰§è¡Œ<code>queueWatcher</code>çš„æ—¶å€™ï¼Œæ­¤æ—¶çš„<code>flushing</code>ä¸º<code>false</code>ï¼Œèµ°<code>else</code>åˆ†æ”¯é€»è¾‘ï¼Œ<code>while</code>å¾ªç¯çš„ä½œç”¨ä¸»è¦æ˜¯ä¸ºäº†æŸ¥æ‰¾åº”è¯¥åœ¨<code>queue</code>æ•°ç»„ä»€ä¹ˆä½ç½®æ’å…¥æ–°çš„<code>watcher</code>ï¼Œä¾‹å¦‚ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'user watcher'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'render watcher'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token comment">// å½“æ‰§è¡Œwatchç›‘å¬å‡½æ•°çš„æ—¶å€™ï¼Œæ­¤æ—¶çš„watcheråº”è¯¥æ’å…¥åˆ°æ•°ç»„ç¬¬äºŒé¡¹</span>
<span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'user watcher'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'user watcher'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">'render watcher'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>å› ä¸ºæˆ‘ä»¬æ’°å†™çš„ç‰¹æ®Šä¾‹å­ï¼Œ<code>queue</code>æ•°ç»„ä¼šä¸æ–­çš„æ¨å…¥<code>user watcher</code>ï¼Œå½“<code>queue</code>ä¸­çš„æ•°é‡è¶…è¿‡é™åˆ¶çš„æ—¶å€™ï¼Œ<code>Vue.js</code>æå‰ç»ˆæ­¢è¿™ç§è¡Œä¸º(æŸäº›<code>Watcher</code>è¢«éå†è¶…è¿‡100æ¬¡æ—¶)ï¼Œ<code>Vue.js</code>ä½¿ç”¨<code>circular</code>æ ‡è®°å¯¹è±¡æ¥è¿›è¡Œè®¡æ•°ï¼Œå®ƒæ ‡è®°äº†æ¯ä¸€ä¸ª<code>Watcher</code>è¢«éå†çš„æ¬¡æ•°ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// idä¸º1çš„Watcherè¢«éå†äº†101æ¬¡</span>
<span class="token comment">// idä¸º2çš„Watcherè¢«éå†äº†1æ¬¡</span>
<span class="token keyword">const</span> circular <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token number">101</span><span class="token punctuation">,</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>circular</code>è®¡æ•°æ›´æ–°å’Œç»ˆæ­¢çš„ä»£ç åœ¨<code>flushSchedulerQueue</code>å‡½æ•°ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> queue<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  watcher <span class="token operator">=</span> queue<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>before<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    watcher<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id
  has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
  watcher<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// in dev build, check and stop circular updates.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token constant">MAX_UPDATE_COUNT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token string">'You may have an infinite update loop '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>
          watcher<span class="token punctuation">.</span>user
            <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">in watcher with expression &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>watcher<span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span>
            <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">in a component render function.</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        watcher<span class="token punctuation">.</span>vm
      <span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å› æ­¤å¯¹äºä»¥ä¸Šä¾‹å­ï¼Œ<code>Vue.js</code>ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºè¿™æ ·ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// You may have an infinite update loop in watcher with expression &quot;msg&quot;</span>
</code></pre></div><h2 id="æ•´ä½“æµç¨‹å›¾"><a href="#æ•´ä½“æµç¨‹å›¾" class="header-anchor">#</a> æ•´ä½“æµç¨‹å›¾</h2> <p>åœ¨åˆ†æå®Œä»¥ä¸Šæ´¾å‘æ›´æ–°çš„è¿‡ç¨‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹æµç¨‹å›¾ã€‚</p> <div style="text-align:center;"><img src="/assets/img/notify.2989b321.png" alt="æ´¾å‘æ›´æ–°æµç¨‹"></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">11/4/2020, 9:13:53 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/vueAnalysis/reactive/dep.html" class="prev">
        ä¾èµ–æ”¶é›†
      </a></span> <span class="next"><a href="/vueAnalysis/reactive/nexttick.html">
        nextTickå®ç°åŸç†
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><APlayer audio="" fixed="true" autoplay="autoplay" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div id="goTop" class="hide-cat" data-v-bf92849a></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/assets/js/app.d98f75d3.js" defer></script><script src="/assets/js/7.9b6d0533.js" defer></script><script src="/assets/js/49.21eaf609.js" defer></script>
  </body>
</html>
